<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>小菜鸟的温暖小窝</title>
  
  
  <link href="https://kdt-g.github.io/atom.xml" rel="self"/>
  
  <link href="https://kdt-g.github.io/"/>
  <updated>2022-03-26T18:35:21.526Z</updated>
  <id>https://kdt-g.github.io/</id>
  
  <author>
    <name>小菜鸟</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>第一个微信小程序应用示例</title>
    <link href="https://kdt-g.github.io/2022/03/28/create_wechat_first/"/>
    <id>https://kdt-g.github.io/2022/03/28/create_wechat_first/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:35:21.526Z</updated>
    
    <content type="html"><![CDATA[<h4 id="具体部分"><a href="#具体部分" class="headerlink" title="具体部分"></a>具体部分</h4><span id="more"></span><blockquote><p>wxml部分</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--miniprogram/pages/index/index.wxml--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;movie&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;moveList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;item&quot;</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&#x27;&#123;&#123;item.ImgSrc&#125;&#125;&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;movie-img&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;movie-info&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;movie-title&quot;</span>&gt;</span>&#123;&#123;item.CN_Title&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span> <span class="tag">&lt;<span class="name">text</span> <span class="attr">style</span>=<span class="string">&quot;color:&#x27;#00A65F&#x27;&quot;</span>&gt;</span> Top&#123;&#123;item.uid&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">text</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.EN_Title !== &#x27; &#x27;&#125;&#125;&quot;</span>&gt;</span>别名：&#123;&#123;item.EN_Title&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">text</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.EN_Title == &#x27; &#x27;&#125;&#125;&quot;</span>&gt;</span>别名：暂无<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>观众评分：</span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;movie-score&quot;</span>&gt;</span> &#123;&#123;item.Rating&#125;&#125;分<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>评分人数：</span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> &gt;</span>&#123;&#123;item.Judge&#125;&#125; <span class="tag">&lt;<span class="name">text</span> &gt;</span>人评价<span class="tag">&lt;/<span class="name">text</span>&gt;</span> <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.Inq !== &#x27; &#x27;&#125;&#125;&quot;</span>&gt;</span>点评: “&#123;&#123;item.Inq&#125;&#125;”<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.Inq == &#x27; &#x27;&#125;&#125;&quot;</span>&gt;</span>点评: 暂无<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> &gt;</span>详情链接:<span class="tag">&lt;<span class="name">text</span> <span class="attr">style</span>=<span class="string">&quot;color:blue&quot;</span> <span class="attr">data-text</span>=<span class="string">&quot;&#123;&#123;item.Link&#125;&#125;&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;textPaste&quot;</span>&gt;</span>点击复制<span class="tag">&lt;/<span class="name">text</span>&gt;</span> <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">&lt;/view &gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;has-no-more&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;end&#125;&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;font-size:20rpx;&quot;</span>&gt;</span>---没有更多了---<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;gotop&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;ToTop&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;btn-gotop&quot;</span> <span class="attr">style</span>=<span class="string">&quot;&quot;</span>&gt;</span>顶部<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>wxss部分</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* miniprogram/pages/index/index.wxss */</span></span><br><span class="line"><span class="selector-class">.movie</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.movie-img</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200</span>rpx;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300</span>rpx;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.movie-info</span>&#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.8</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.movie-title</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">40</span>rpx;</span><br><span class="line">  <span class="attribute">font-weight</span>: bolder;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.movie-score</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#faaf00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.movie-comment</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#E54847</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">120</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#808080</span>;</span><br><span class="line">  <span class="attribute">border</span>: black;</span><br><span class="line">  <span class="attribute">margin-left</span>:<span class="number">85%</span>;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">48px</span>; </span><br><span class="line">  <span class="attribute">height</span>: <span class="number">48px</span>;</span><br><span class="line">  <span class="attribute">position</span>:fixed; </span><br><span class="line">  <span class="attribute">bottom</span>:<span class="number">40px</span>; </span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">opacity</span>:<span class="number">0.5</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.btn-gotop</span> </span><br><span class="line">  &#123; </span><br><span class="line">  <span class="attribute">color</span>:white; </span><br><span class="line">  <span class="attribute">position</span>:absolute;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0.8rem</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">0.4rem</span></span><br><span class="line">  &#125; </span><br></pre></td></tr></table></figure><blockquote><p>js部分</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// miniprogram/pages/index/index.js</span></span><br><span class="line"><span class="keyword">const</span> db = wx.<span class="property">cloud</span>.<span class="title function_">database</span>()</span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">data</span>: &#123;    </span><br><span class="line">      <span class="attr">moveList</span>:[],</span><br><span class="line">      <span class="attr">start</span>:<span class="number">0</span>,</span><br><span class="line">      <span class="attr">cout</span>:<span class="number">20</span>,</span><br><span class="line">      <span class="title class_">ToTop</span>:<span class="literal">false</span>,</span><br><span class="line">      <span class="attr">end</span>:<span class="literal">false</span>,</span><br><span class="line">      <span class="attr">s</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">textPaste</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="comment">//点击复制</span></span><br><span class="line">    wx.<span class="title function_">setClipboardData</span>(&#123;</span><br><span class="line">      <span class="attr">data</span>: e.<span class="property">currentTarget</span>.<span class="property">dataset</span>.<span class="property">text</span>,</span><br><span class="line">      <span class="attr">success</span>:<span class="keyword">function</span>(<span class="params">res</span>)&#123;</span><br><span class="line">         wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;复制成功&#x27;</span>,</span><br><span class="line">         &#125;)</span><br><span class="line">        <span class="comment">/*wx.getClipboardData(&#123;//获取复制内容</span></span><br><span class="line"><span class="comment">          success: function(res)&#123;</span></span><br><span class="line"><span class="comment">            console.log(res.data)</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">        &#125;)*/</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"> &#125;,</span><br><span class="line">  <span class="attr">onPageScroll</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123; <span class="comment">// 获取滚动条当前位置</span></span><br><span class="line">    <span class="keyword">if</span>(e.<span class="property">scrollTop</span>&gt;<span class="number">400</span>)&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">         <span class="title class_">ToTop</span>:<span class="literal">true</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="title class_">ToTop</span>:<span class="literal">false</span></span><br><span class="line">     &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">  <span class="attr">gotop</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="comment">//返回顶部</span></span><br><span class="line">    <span class="keyword">if</span> (wx.<span class="property">pageScrollTo</span>) &#123;  </span><br><span class="line">      wx.<span class="title function_">pageScrollTo</span>(&#123;</span><br><span class="line">        <span class="attr">scrollTop</span>: <span class="number">0</span></span><br><span class="line">      &#125;);    </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      wx.<span class="title function_">showModal</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;提示&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&#x27;当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">K</span>:<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;加载中&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">var</span> start = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">start</span>;</span><br><span class="line">    <span class="keyword">var</span> cout =<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">cout</span>;</span><br><span class="line">    db.<span class="title function_">collection</span>(<span class="string">&#x27;douban&#x27;</span>).<span class="title function_">skip</span>(start).<span class="title function_">limit</span>(cout).<span class="title function_">get</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">moveList</span>:<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">moveList</span>.<span class="title function_">concat</span>(res.<span class="property">data</span>),</span><br><span class="line">        <span class="attr">start</span>:start+cout</span><br><span class="line">      &#125;);</span><br><span class="line">      wx.<span class="title function_">hideLoading</span>();</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onLoad</span>: <span class="keyword">function</span> (<span class="params">options</span>) &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面初次渲染完成</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onReady</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">K</span>();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面显示</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onShow</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面隐藏</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onHide</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面卸载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onUnload</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面相关事件处理函数--监听用户下拉动作</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onPullDownRefresh</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面上拉触底事件的处理函数</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onReachBottom</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">K</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">start</span>&gt;=<span class="number">240</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">end</span>:<span class="literal">true</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 用户点击右上角分享</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">onShareAppMessage</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;具体部分&quot;&gt;&lt;a href=&quot;#具体部分&quot; class=&quot;headerlink&quot; title=&quot;具体部分&quot;&gt;&lt;/a&gt;具体部分&lt;/h4&gt;</summary>
    
    
    
    
    <category term="微信小程序" scheme="https://kdt-g.github.io/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>VSCode中给方法添加注释头(C#)</title>
    <link href="https://kdt-g.github.io/2022/03/28/csharp_addzhushi/"/>
    <id>https://kdt-g.github.io/2022/03/28/csharp_addzhushi/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:31:29.853Z</updated>
    
    <content type="html"><![CDATA[<p>使用C# XML Documentation Comments插件<br>快捷键 &#x2F;&#x2F;&#x2F;</p><span id="more"></span><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;a&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;b&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoSomething</span>(<span class="params"><span class="built_in">float</span> a,<span class="built_in">string</span> b</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>转自：<a href="https://blog.csdn.net/hbflyhbfly/article/details/86542362">https://blog.csdn.net/hbflyhbfly/article/details/86542362</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;使用C# XML Documentation Comments插件&lt;br&gt;快捷键 &amp;#x2F;&amp;#x2F;&amp;#x2F;&lt;/p&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
    <category term="插件" scheme="https://kdt-g.github.io/tags/%E6%8F%92%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>钩子程序</title>
    <link href="https://kdt-g.github.io/2022/03/28/gouzichengxu/"/>
    <id>https://kdt-g.github.io/2022/03/28/gouzichengxu/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:47:12.457Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote><p>​            钩子(Hook)，是Windows消息处理机制的一个平台，应用程序可以在上面设置子程序以监视指定窗口的某种消息，而且所监视的窗口可以是其他进程所创建的。当消息到达后，在目标窗口处理函数之前处理它。钩子机制允许应用程序截获处理Windows消息或特定事件。<br>中文名钩子程序外文名Hook类    型处理消息的程序段平    台Windows消息处理机制的一个平台</p></blockquote><span id="more"></span><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>1 基本概念<br>2 运行机制<br>3 分类<br>4 常用类型</p><h3 id="1-基本概念编辑"><a href="#1-基本概念编辑" class="headerlink" title="1.基本概念编辑"></a>1.基本概念编辑</h3><p>在某种操作后弹出的关于钩子程序的界面<br>在某种操作后弹出的关于钩子程序的界面<br>钩子实际上是一个处理消息的程序段，通过系统调用，把它挂入系统。每当特定的消息发出，在没有到达目的窗口前，钩子程序就先捕获该消息，亦即钩子函数先得到控制权。这时钩子函数即可以加工处理（改变）该消息，也可以不作处理而继续传递该消息，还可以强制结束消息的传递。<br>钩子也可以理解为WINDOWS留给我们的后门，比如你想控制键盘，在DOS时代很简单通过INT即可，而WINDOWS时代不允许我们直接操作硬件；由于WINDOWS是消息驱动，所以我们可以拦截键盘消息以达到控制键盘的目的。控制自己进程的消息固然很简单，但是要控制所有进程消息就要利用钩子了。将钩子函数放在DLL中，所有的有关键盘的消息都必须经过钩子函数过滤，这样你就可以为所欲为了。<br>WINDOWS下的钩子程序就像DOS下的TSR(内存驻留程序)一样，用来截获WINDOWS下的消息。</p><h3 id="2-运行机制编辑"><a href="#2-运行机制编辑" class="headerlink" title="2.运行机制编辑"></a>2.运行机制编辑</h3><p>每一个Hook(钩子)都有一个与之相关联的指针列表，称之为钩子链表，由系统来维护。这个列表的指针指向指定的，应用程序定义的，被Hook子程调用的回调函数，也就是该钩子的各个处理子程。当与指定的Hook类型关联的消息发生时，系统就把这个消息传递到Hook子程。 一些Hook子程可以只监视消息，或者修改消息，或者停止消息的前进，避免这些消息传递到下一个Hook子程或者目的窗口。最近安装的钩子放在链的开始， 而最早安装的钩子放在最后，也就是后加入的先获得控制权。<br>Windows 并不要求钩子子程的卸载顺序一定得和安装顺序相反。每当有一个钩子被卸载，Windows 便释放其占用的内存，并更新整个Hook链表。如果程序安装了钩子，但是在尚未卸载钩子之前就结束了，那么系统会自动为它做卸载钩子的操作。</p><h3 id="3-分类编辑"><a href="#3-分类编辑" class="headerlink" title="3.分类编辑"></a>3.分类编辑</h3><p>按事件分类<br>有如下的几种常用类型<br>（1）键盘钩子和低级键盘钩子可以监视各种键盘消息。<br>（2） 鼠标钩子和低级鼠标钩子可以监视各种鼠标消息。<br>（3） 外壳钩子可以监视各种Shell事件消息。比如启动和关闭应用程序。<br>（4）日志钩子可以记录从系统消息队列中取出的各种事件消息。<br>（5） 窗口过程钩子监视所有从系统消息队列发往目标窗口的消息。<br>此外，还有一些特定事件的钩子提供给我们使用，不一一列举。<br>按使用范围分类<br>主要有线程钩子和系统钩子<br>（1） 线程钩子监视指定线程的事件消息。<br>（2）系统钩子监视系统中的所有线程的事件消息。因为系统钩子会影响系统中所有的应用程序，所以钩子函数必须放在独立的动态链接库(DLL)中。这是系统钩子和线程钩子很大的不同之处。<br>几点需要说明的地方：<br>（1） 如果对于同一事件（如鼠标消息）既安装了线程钩子又安装了系统钩子，那么系统会自动先调用线程钩子，然后调用系统钩子。<br>（2） 对同一事件消息可安装多个钩子处理过程，这些钩子处理过程形成了钩子链。当前钩子处理结束后应把钩子信息传递给下一个钩子函数。而且最近安装的钩子放在链的开始，而最早安装的钩子放在最后，也就是后加入的先获得控制权。<br>（3） 钩子特别是系统钩子会消耗消息处理时间，降低系统性能。只有在必要的时候才安装钩子，在使用完毕后要及时卸载。</p><h3 id="4-常用类型编辑"><a href="#4-常用类型编辑" class="headerlink" title="4.常用类型编辑"></a>4.常用类型编辑</h3><p>WH_CALLWNDPROC<br>1、WH_CALLWNDPROC和WH_CALLWNDPROCRET Hooks<br>WH_CALLWNDPROC和WH_CALLWNDPROCRET Hooks使你可以监视发送到窗口过程的消息。系统在消息发送到接收窗口过程之前调用WH_CALLWNDPROC Hook子程，并且在窗口过程处理完消息之后调用WH_CALLWNDPROCRET Hook子程。<br>WH_CALLWNDPROCRET Hook传递指针到CWPRETSTRUCT结构，再传递到Hook子程。CWPRETSTRUCT结构包含了来自处理消息的窗口过程的返回值，同样也包括了与这个消息关联的消息参数。<br>WH_CBT Hook<br>在以下事件之前，系统都会调用WH_CBT Hook子程，这些事件包括：</p><ol><li>激活，建立，销毁，最小化，最大化，移动，改变尺寸等窗口事件；</li><li>完成系统指令；</li><li>来自系统消息队列中的移动鼠标，键盘事件；</li><li>设置输入焦点事件；</li><li>同步系统消息队列事件。<br>Hook子程的返回值确定系统是否允许或者防止这些操作中的一个。<br>WH_DEBUG Hook<br>在系统调用系统中与其他Hook关联的Hook子程之前，系统会调用WH_DEBUG Hook子程。你可以使用这个Hook来决定是否允许系统调用与其他Hook关联的Hook子程。<br>WH_FOREGROUNDIDLE Hook<br>当应用程序的前台线程处于空闲状态时，可以使用WH_FOREGROUNDIDLE Hook执行低优先级的任务。当应用程序的前台线程大概要变成空闲状态时，系统就会调用WH_FOREGROUNDIDLE Hook子程。<br>WH_GETMESSAGE Hook<br>应用程序使用WH_GETMESSAGE Hook来监视从GetMessage or PeekMessage函数返回的消息。你可以使用WH_GETMESSAGE Hook去监视鼠标和键盘输入，以及其他发送到消息队列中的消息。<br>WH_JOURNALPLAYBACK Hook<br>WH_JOURNALPLAYBACK Hook使应用程序可以插入消息到系统消息队列。可以使用这个Hook回放通过使用WH_JOURNALRECORD Hook记录下来的连续的鼠标和键盘事件。只要WH_JOURNALPLAYBACK Hook已经安装，正常的鼠标和键盘事件就是无效的。<br>WH_JOURNALPLAYBACK Hook是全局Hook，它不能象线程特定Hook一样使用。 WH_JOURNALPLAYBACK Hook返回超时值，这个值告诉系统在处理来自回放Hook当前消息之前需要等待多长时间（毫秒）。这就使Hook可以控制实时事件的回放。<br>WH_JOURNALPLAYBACK是system-wide local hooks，它们不会被注射到任何行程位址空间。（估计按键精灵是用这个hook做的）<br>WH_JOURNALRECORD Hook<br>WH_JOURNALRECORD Hook用来监视和记录输入事件。典型的，可以使用这个Hook记录连续的鼠标和键盘事件，然后通过使用WH_JOURNALPLAYBACK Hook来回放。<br>WH_JOURNALRECORD Hook是全局Hook，它不能象线程特定Hook一样使用。<br>WH_JOURNALRECORD是system-wide local hooks，它们不会被注射到任何行程位址空间。<br>WH_KEYBOARD Hook<br>在应用程序中，WH_KEYBOARD Hook用来监视WM_KEYDOWN and WM_KEYUP消息，这些消息通过GetMessage or PeekMessage function返回。可以使用这个Hook来监视输入到消息队列中的键盘消息。<br>WH_KEYBOARD_LL Hook<br>WH_KEYBOARD_LL Hook监视输入到线程消息队列中的键盘消息。<br>WH_MOUSE Hook<br>WH_MOUSE Hook监视从GetMessage 或者 PeekMessage 函数返回的鼠标消息。使用这个Hook监视输入到消息队列中的鼠标消息。<br>WH_MOUSE_LL Hook<br>WH_MOUSE_LL Hook监视输入到线程消息队列中的鼠标消息。<br>WH_MSGFILTER &#x2F; hooks<br>WH_MSGFILTER 和 WH_SYSMSGFILTER Hooks<br>WH_MSGFILTER 和 WH_SYSMSGFILTER Hooks使我们可以监视菜单，滚动条，消息框，对话框消息并且发现用户使用ALT+TAB or ALT+ESC 组合键切换窗口。<br>WH_MSGFILTER Hook只能监视传递到菜单，滚动条，消息框的消息，以及传递到通过安装了Hook子程的应用程序建立的对话框的消息。<br>WH_SYSMSGFILTER Hook监视所有应用程序消息。<br>WH_MSGFILTER 和 WH_SYSMSGFILTER Hooks使我们可以在模式循环期间过滤消息，这等价于在主消息循环中过滤消息。通过调用CallMsgFilter function可以直接的调用WH_MSGFILTER Hook。通过使用这个函数，应用程序能够在模式循环期间使用相同的代码去过滤消息，如同在主消息循环里一样。<br>WH_SHELL Hook<br>外壳应用程序可以使用WH_SHELL Hook去接收重要的通知。当外壳应用程序是激活的并且当顶层窗口建立或者销毁时，系统调用WH_SHELL Hook子程。<br>WH_SHELL 共有5钟情况：</li><li>只要有个top-level、unowned 窗口被产生、起作用、或是被摧毁；</li><li>当Taskbar需要重画某个按钮；</li><li>当系统需要显示关于Taskbar的一个程序的最小化形式；</li><li>键盘布局状态改变；</li><li>当使用者按Ctrl+Esc去执行Task Manager（或相同级别的程序）。<br>按照惯例，外壳应用程序都不接收WH_SHELL消息。所以，在应用程序能够接收WH_SHELL消息之前，应用程序必须调用SystemParametersInfo function注册它自己。</li></ol><p>转自：<a href="https://baike.baidu.com/item/%E9%92%A9%E5%AD%90%E7%A8%8B%E5%BA%8F/10772325">https://baike.baidu.com/item/钩子程序/10772325</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;​            钩子(Hook)，是Windows消息处理机制的一个平台，应用程序可以在上面设置子程序以监视指定窗口的某种消息，而且所监视的窗口可以是其他进程所创建的。当消息到达后，在目标窗口处理函数之前处理它。钩子机制允许应用程序截获处理Windows消息或特定事件。&lt;br&gt;中文名钩子程序外文名Hook类    型处理消息的程序段平    台Windows消息处理机制的一个平台&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>jq在线引用地址大全</title>
    <link href="https://kdt-g.github.io/2022/03/28/jq_src/"/>
    <id>https://kdt-g.github.io/2022/03/28/jq_src/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:39:57.355Z</updated>
    
    <content type="html"><![CDATA[<p>1.官网jquery压缩版引用地址:</p><span id="more"></span><p>　3.1.1版本:</p><p>　　<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script></p><p>   3.0.0版本:</p><p>　　<script src="https://code.jquery.com/jquery-3.0.0.min.js"></script></p><p>　2.1.4版本:</p><p>　　<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script></p><p>2.百度压缩版引用地址:</p><p>　　<script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script></p><p>3.微软压缩版引用地址:</p><p>　　<script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-2.1.4.min.js"></script></p><br /><p>转自：<a href="https://blog.csdn.net/weixin_42630877/article/details/83096998">https://blog.csdn.net/weixin_42630877&#x2F;article&#x2F;details&#x2F;83096998</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;1.官网jquery压缩版引用地址:&lt;/p&gt;</summary>
    
    
    
    
    <category term="前端" scheme="https://kdt-g.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>简单使用Node.js连接MySql数据库进行增删改查</title>
    <link href="https://kdt-g.github.io/2022/03/28/nodejs_test/"/>
    <id>https://kdt-g.github.io/2022/03/28/nodejs_test/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:42:16.100Z</updated>
    
    <content type="html"><![CDATA[<p>##连接数据库</p><span id="more"></span><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入mysql（既然要使用它，当然要引入啦）</span></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>); </span><br><span class="line"> </span><br><span class="line"><span class="comment">//连接mysql,option可很具情况自行配置</span></span><br><span class="line"><span class="keyword">const</span> option = &#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&quot;主机地址&quot;</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="string">&quot;Mysql用户名&quot;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&quot;Mysql用户密码&quot;</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&quot;数据库名称&quot;</span>,</span><br><span class="line">  <span class="attr">port</span>: <span class="string">&#x27;端口号&#x27;</span>,</span><br><span class="line">  <span class="attr">connectTimeout</span>: <span class="number">5000</span>, <span class="comment">// 连接超时</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> connection = mysql.<span class="title function_">createConnection</span>(option);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//连接开始</span></span><br><span class="line">connection.<span class="title function_">connect</span>(<span class="keyword">function</span>(<span class="params">err</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;连接失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;连接成功&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>##增</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> userAddSql = <span class="string">&#x27;INSERT INTO userinfo(Id,UserName,UserPass) VALUES(0,?,?)&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> userAddSql_Params = [<span class="string">&#x27;Wilson&#x27;</span>,<span class="string">&#x27;abcd&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//增</span></span><br><span class="line"> connection.<span class="title function_">query</span>(userAddSql,userAddSql_Params,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"> <span class="keyword">if</span>(err)&#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[INSERT ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------INSERT----------------------------&#x27;</span>);</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;INSERT  ID:&#x27;</span>,result);</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><p>##改</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> userModSql = <span class="string">&#x27;UPDATE userinfo SET UserName =?,UserPass = ?  WHERE Id = ?&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> userModSql_Params = [<span class="string">&#x27;钟馗&#x27;</span>,<span class="string">&#x27;5678&#x27;</span>,<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//改</span></span><br><span class="line"></span><br><span class="line">connection.<span class="title function_">query</span>(userModSql,userModSql_Params,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[UPDATE ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------UPDATE----------------------------&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;UPDATE affectedRows&#x27;</span>,result);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>##查</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> userGetSql = <span class="string">&#x27;SELECT * FROM userinfo&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//查</span></span><br><span class="line"> connection.<span class="title function_">query</span>(userGetSql,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[SELECT ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"> <span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------SELECT----------------------------&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);        </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);  </span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><p>##删</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> userDelSql = <span class="string">&#x27;DELETE FROM userinfo&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删</span></span><br><span class="line">connection.<span class="title function_">query</span>(userDelSql,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (err) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[DELETE ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------DELETE----------------------------&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;DELETE affectedRows&#x27;</span>,result);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>##结束连接</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.<span class="title function_">end</span>()</span><br></pre></td></tr></table></figure><p>##完整代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//引入mysql（既然要使用它，当然要引入啦）</span></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>); </span><br><span class="line"> </span><br><span class="line"><span class="comment">//连接mysql,option可很具情况自行配置</span></span><br><span class="line"><span class="keyword">const</span> option = &#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&quot;101.201.145.134&quot;</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="string">&quot;TestDB&quot;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&quot;Wa8emaaN7ShSkcyR&quot;</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&quot;TestDB&quot;</span>,</span><br><span class="line">  <span class="attr">port</span>: <span class="string">&#x27;3306&#x27;</span>,</span><br><span class="line">  <span class="attr">connectTimeout</span>: <span class="number">5000</span>, <span class="comment">// 连接超时</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> connection = mysql.<span class="title function_">createConnection</span>(option);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//连接开始</span></span><br><span class="line">connection.<span class="title function_">connect</span>(<span class="keyword">function</span>(<span class="params">err</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;连接失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;连接成功&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//这里就是增删改查的地方啦</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> userAddSql = <span class="string">&#x27;INSERT INTO userinfo(Id,UserName,UserPass) VALUES(0,?,?)&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> userAddSql_Params = [<span class="string">&#x27;Wilson&#x27;</span>,<span class="string">&#x27;abcd&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//增</span></span><br><span class="line">connection.<span class="title function_">query</span>(userAddSql,userAddSql_Params,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[INSERT ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------INSERT----------------------------&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;INSERT  ID:&#x27;</span>,result);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">var</span> userModSql = <span class="string">&#x27;UPDATE userinfo SET UserName =?,UserPass = ?  WHERE Id = ?&#x27;</span>;</span><br><span class="line"> <span class="keyword">var</span> userModSql_Params = [<span class="string">&#x27;钟馗&#x27;</span>,<span class="string">&#x27;5678&#x27;</span>,<span class="number">1</span>];</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//改</span></span><br><span class="line"> </span><br><span class="line"> connection.<span class="title function_">query</span>(userModSql,userModSql_Params,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[UPDATE ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------UPDATE----------------------------&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;UPDATE affectedRows&#x27;</span>,result);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);</span><br><span class="line"> &#125;);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">var</span> userGetSql = <span class="string">&#x27;SELECT * FROM userinfo&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//查</span></span><br><span class="line"> connection.<span class="title function_">query</span>(userGetSql,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[SELECT ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"> <span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------SELECT----------------------------&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);        </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);  </span><br><span class="line"> &#125;);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">var</span> userDelSql = <span class="string">&#x27;DELETE FROM userinfo&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//删</span></span><br><span class="line"> connection.<span class="title function_">query</span>(userDelSql,<span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (err) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[DELETE ERROR] - &#x27;</span>,err.<span class="property">message</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------DELETE----------------------------&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;DELETE affectedRows&#x27;</span>,result);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----------------------------------------------------------------\n\n&#x27;</span>);  </span><br><span class="line"> &#125;);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="comment">//结束连接</span></span><br><span class="line"> connection.<span class="title function_">end</span>()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>学自：<em><a href="https://www.cnblogs.com/zhongweiv/p/nodejs_mysql.html">https://www.cnblogs.com/zhongweiv/p/nodejs_mysql.html</a></em></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;##连接数据库&lt;/p&gt;</summary>
    
    
    
    
    <category term="Node.js" scheme="https://kdt-g.github.io/tags/Node-js/"/>
    
  </entry>
  
  <entry>
    <title>字符串和Unicode互转</title>
    <link href="https://kdt-g.github.io/2022/03/28/string_to_unicode/"/>
    <id>https://kdt-g.github.io/2022/03/28/string_to_unicode/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:36:54.119Z</updated>
    
    <content type="html"><![CDATA[<h4 id="字符串转Unicode"><a href="#字符串转Unicode" class="headerlink" title="字符串转Unicode"></a>字符串转Unicode</h4><span id="more"></span><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> 字符串转Unicode</span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;source&quot;&gt;</span>源字符串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>Unicode编码后的字符串<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">StringUnicode</span>(<span class="params"><span class="built_in">string</span> source</span>)</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="built_in">byte</span>[] bytes = Encoding.Unicode.GetBytes(source);</span><br><span class="line">           StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">           <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; bytes.Length; i += <span class="number">2</span>)</span><br><span class="line">           &#123;</span><br><span class="line">               stringBuilder.AppendFormat(<span class="string">&quot;\\u&#123;0&#125;&#123;1&#125;&quot;</span>, bytes[i + <span class="number">1</span>].ToString(<span class="string">&quot;x&quot;</span>).PadLeft(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>), bytes[i].ToString(<span class="string">&quot;x&quot;</span>).PadLeft(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>));</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">return</span> stringBuilder.ToString();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Unicode转字符串"><a href="#Unicode转字符串" class="headerlink" title="Unicode转字符串"></a>Unicode转字符串</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> Unicode转字符串</span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;source&quot;&gt;</span>经过Unicode编码的字符串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>正常字符串<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">UnicodeString</span>(<span class="params"><span class="built_in">string</span> source</span>)</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">new</span> Regex(<span class="string">@&quot;\\u([0-9A-F]&#123;4&#125;)&quot;</span>, RegexOptions.IgnoreCase | RegexOptions.Compiled).Replace(</span><br><span class="line">               source, x =&gt; <span class="built_in">string</span>.Empty + Convert.ToChar(Convert.ToUInt16(x.Result(<span class="string">&quot;$1&quot;</span>), <span class="number">16</span>)));</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;字符串转Unicode&quot;&gt;&lt;a href=&quot;#字符串转Unicode&quot; class=&quot;headerlink&quot; title=&quot;字符串转Unicode&quot;&gt;&lt;/a&gt;字符串转Unicode&lt;/h4&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>将获取到的秒数转换为年月日时分秒</title>
    <link href="https://kdt-g.github.io/2022/03/28/time_convert/"/>
    <id>https://kdt-g.github.io/2022/03/28/time_convert/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:33:05.750Z</updated>
    
    <content type="html"><![CDATA[<p>代码如下</p><span id="more"></span><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Nowtime</span>(time)&#123;</span><br><span class="line">    <span class="comment">//年=12个月  月=30天  天=24小时   小时=60分钟  分钟=60秒</span></span><br><span class="line">    <span class="comment">//12*30*24*60*60</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> y=<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>*<span class="number">12</span>,m=<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>,d=<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>,h=<span class="number">60</span>*<span class="number">60</span>,mm=<span class="number">60</span>;</span><br><span class="line">    <span class="comment">//年</span></span><br><span class="line">    <span class="keyword">var</span> Y =<span class="title class_">Math</span>.<span class="title function_">floor</span>(time/y);</span><br><span class="line">    <span class="comment">//月</span></span><br><span class="line">    <span class="keyword">var</span> M = <span class="title class_">Math</span>.<span class="title function_">floor</span>(time/m)-(Y*m);</span><br><span class="line">    M=M&lt;<span class="number">10</span>?<span class="string">&quot;0&quot;</span>+<span class="attr">M</span>:M;</span><br><span class="line">    <span class="comment">//日</span></span><br><span class="line">    <span class="keyword">var</span> D = <span class="title class_">Math</span>.<span class="title function_">floor</span>(time/d)-(((Y*m*d)+(M*d)));</span><br><span class="line">    D=D&lt;<span class="number">10</span>?<span class="string">&quot;0&quot;</span>+<span class="attr">D</span>:D;</span><br><span class="line">    <span class="comment">//时</span></span><br><span class="line">    <span class="keyword">var</span> H =<span class="title class_">Math</span>.<span class="title function_">floor</span>(time/h)-(((Y*m*d*h)+(M*d*h)+(D*h)));</span><br><span class="line">    H=H&lt;<span class="number">10</span>?<span class="string">&quot;0&quot;</span>+<span class="attr">H</span>:H;</span><br><span class="line">    <span class="comment">//分</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Mm</span> = <span class="title class_">Math</span>.<span class="title function_">floor</span>(time/mm)-(((Y*m*d*h*mm)+(M*d*h*mm)+(D*h*mm)+(H*mm)));</span><br><span class="line">    <span class="title class_">Mm</span>=<span class="title class_">Mm</span>&lt;<span class="number">10</span>?<span class="string">&quot;0&quot;</span>+<span class="title class_">Mm</span>:<span class="title class_">Mm</span>;</span><br><span class="line">    <span class="comment">//秒</span></span><br><span class="line">    <span class="keyword">var</span> S = time%mm;</span><br><span class="line">    S=S&lt;<span class="number">10</span>?<span class="string">&quot;0&quot;</span>+<span class="attr">S</span>:S;</span><br><span class="line">    <span class="keyword">var</span> data=Y +<span class="string">&quot;年&quot;</span>+ M+<span class="string">&quot;月&quot;</span> + D +<span class="string">&quot;日&quot;</span> + H +<span class="string">&quot;:&quot;</span> + <span class="title class_">Mm</span> +<span class="string">&quot;:&quot;</span> + S;</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;代码如下&lt;/p&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>简单在Unity中使用c#扩展方法</title>
    <link href="https://kdt-g.github.io/2022/03/28/unity_kuozhanfangfa/"/>
    <id>https://kdt-g.github.io/2022/03/28/unity_kuozhanfangfa/</id>
    <published>2022-03-27T16:00:00.000Z</published>
    <updated>2022-03-26T18:29:21.828Z</updated>
    
    <content type="html"><![CDATA[<h3 id="扩展方法声明"><a href="#扩展方法声明" class="headerlink" title="扩展方法声明"></a>扩展方法声明</h3><span id="more"></span><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyHelp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 返回Hello World</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;x&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>Hello World<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Print</span>(<span class="params"><span class="keyword">this</span> Transform x</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="扩展方法调用"><a href="#扩展方法调用" class="headerlink" title="扩展方法调用"></a>扩展方法调用</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> MyHelp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Test</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> _Test()</span><br><span class="line">    &#123;</span><br><span class="line">        transform.Print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;扩展方法声明&quot;&gt;&lt;a href=&quot;#扩展方法声明&quot; class=&quot;headerlink&quot; title=&quot;扩展方法声明&quot;&gt;&lt;/a&gt;扩展方法声明&lt;/h3&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>第一篇博客</title>
    <link href="https://kdt-g.github.io/2022/03/26/FirstBlog/"/>
    <id>https://kdt-g.github.io/2022/03/26/FirstBlog/</id>
    <published>2022-03-25T16:00:00.000Z</published>
    <updated>2022-03-26T16:44:34.855Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;Hello,World&quot;</span>);<span class="comment">//你好,世界</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight csharp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span cl</summary>
      
    
    
    
    <category term="随笔" scheme="https://kdt-g.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
    <category term="随笔" scheme="https://kdt-g.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>最全的C#图片处理帮助类ImageHelper.cs</title>
    <link href="https://kdt-g.github.io/2020/08/13/EV4CfMIoF/"/>
    <id>https://kdt-g.github.io/2020/08/13/EV4CfMIoF/</id>
    <published>2020-08-13T03:26:04.000Z</published>
    <updated>2022-03-26T16:44:12.377Z</updated>
    
    <content type="html"><![CDATA[<h2 id="方法介绍："><a href="#方法介绍：" class="headerlink" title="方法介绍："></a>方法介绍：</h2><ul>     <li>生成缩略图</li>     <li>图片水印处理方法</li>     <li>图片水印位置处理方法</li>     <li>文字水印处理方法</li>     <li>文字水印位置的方法</li>     <li>调整光暗</li>     <li>反色处理</li>     <li>浮雕处理</li>     <li>拉伸图片</li>     <li>滤色处理</li>     <li>左右翻转</li>     <li>上下翻转</li>     <li>压缩到指定尺寸</li>     <li>转换为黑白图片</li>     <li>获取图片中的各帧</li></ul><span id="more"></span><h2 id="代码如下："><a href="#代码如下：" class="headerlink" title="代码如下："></a>代码如下：</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> System.Drawing.Imaging;</span><br><span class="line"><span class="keyword">using</span> System.Drawing.Drawing2D;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">HelloCsharp.Utilities</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ImageClass</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ImageClass</span>()</span></span><br><span class="line">&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 缩略图</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 生成缩略图</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>源图路径（物理路径） <span class="doctag">///</span>缩略图路径（物理路径） <span class="doctag">///</span>缩略图宽度 <span class="doctag">///</span>缩略图高度 <span class="doctag">///</span>生成缩略图的方式 public static void MakeThumbnail(string originalImagePath, string thumbnailPath, int width, int height, string mode)</span></span><br><span class="line">&#123;</span><br><span class="line">System.Drawing.Image originalImage = System.Drawing.Image.FromFile(originalImagePath);</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> towidth = width;</span><br><span class="line"><span class="built_in">int</span> toheight = height;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> x = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">int</span> y = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">int</span> ow = originalImage.Width;</span><br><span class="line"><span class="built_in">int</span> oh = originalImage.Height;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (mode)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;HW&quot;</span>:  <span class="comment">//指定高宽缩放（可能变形）</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;W&quot;</span>:   <span class="comment">//指定宽，高按比例</span></span><br><span class="line">toheight = originalImage.Height * width / originalImage.Width;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;H&quot;</span>:   <span class="comment">//指定高，宽按比例</span></span><br><span class="line">towidth = originalImage.Width * height / originalImage.Height;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;Cut&quot;</span>: <span class="comment">//指定高宽裁减（不变形）</span></span><br><span class="line"><span class="keyword">if</span> ((<span class="built_in">double</span>)originalImage.Width / (<span class="built_in">double</span>)originalImage.Height &amp;gt; (<span class="built_in">double</span>)towidth / (<span class="built_in">double</span>)toheight)</span><br><span class="line">&#123;</span><br><span class="line">oh = originalImage.Height;</span><br><span class="line">ow = originalImage.Height * towidth / toheight;</span><br><span class="line">y = <span class="number">0</span>;</span><br><span class="line">x = (originalImage.Width - ow) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">ow = originalImage.Width;</span><br><span class="line">oh = originalImage.Width * height / towidth;</span><br><span class="line">x = <span class="number">0</span>;</span><br><span class="line">y = (originalImage.Height - oh) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="literal">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//新建一个bmp图片</span></span><br><span class="line">System.Drawing.Image bitmap = <span class="keyword">new</span> System.Drawing.Bitmap(towidth, toheight);</span><br><span class="line"></span><br><span class="line"><span class="comment">//新建一个画板</span></span><br><span class="line">System.Drawing.Graphics g = System.Drawing.Graphics.FromImage(bitmap);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置高质量插值法</span></span><br><span class="line">g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.High;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置高质量,低速度呈现平滑程度</span></span><br><span class="line">g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;</span><br><span class="line"></span><br><span class="line"><span class="comment">//清空画布并以透明背景色填充</span></span><br><span class="line">g.Clear(System.Drawing.Color.Transparent);</span><br><span class="line"></span><br><span class="line"><span class="comment">//在指定位置并且按指定大小绘制原图片的指定部分</span></span><br><span class="line">g.DrawImage(originalImage, <span class="keyword">new</span> System.Drawing.Rectangle(<span class="number">0</span>, <span class="number">0</span>, towidth, toheight), <span class="keyword">new</span> System.Drawing.Rectangle(x, y, ow, oh), System.Drawing.GraphicsUnit.Pixel);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//以jpg格式保存缩略图</span></span><br><span class="line">bitmap.Save(thumbnailPath, System.Drawing.Imaging.ImageFormat.Jpeg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (System.Exception e)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">throw</span> e;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">&#123;</span><br><span class="line">originalImage.Dispose();</span><br><span class="line">bitmap.Dispose();</span><br><span class="line">g.Dispose();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 图片水印</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 图片水印处理方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>需要加载水印的图片路径（绝对路径） <span class="doctag">///</span>水印图片（绝对路径） <span class="doctag">///</span>水印位置（传送正确的代码） public static string ImageWatermark(string path, string waterpath, string location)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> kz_name = Path.GetExtension(path);</span><br><span class="line"><span class="keyword">if</span> (kz_name == <span class="string">&quot;.jpg&quot;</span> || kz_name == <span class="string">&quot;.bmp&quot;</span> || kz_name == <span class="string">&quot;.jpeg&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">DateTime time = DateTime.Now;</span><br><span class="line"><span class="built_in">string</span> filename = <span class="string">&quot;&quot;</span> + time.Year.ToString() + time.Month.ToString() + time.Day.ToString() + time.Hour.ToString() + time.Minute.ToString() + time.Second.ToString() + time.Millisecond.ToString();</span><br><span class="line">Image img = Bitmap.FromFile(path);</span><br><span class="line">Image waterimg = Image.FromFile(waterpath);</span><br><span class="line">Graphics g = Graphics.FromImage(img);</span><br><span class="line">ArrayList loca = GetLocation(location, img, waterimg);</span><br><span class="line">g.DrawImage(waterimg, <span class="keyword">new</span> Rectangle(<span class="built_in">int</span>.Parse(loca[<span class="number">0</span>].ToString()), <span class="built_in">int</span>.Parse(loca[<span class="number">1</span>].ToString()), waterimg.Width, waterimg.Height));</span><br><span class="line">waterimg.Dispose();</span><br><span class="line">g.Dispose();</span><br><span class="line"><span class="built_in">string</span> newpath = Path.GetDirectoryName(path) + filename + kz_name;</span><br><span class="line">img.Save(newpath);</span><br><span class="line">img.Dispose();</span><br><span class="line">File.Copy(newpath, path, <span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (File.Exists(newpath))</span><br><span class="line">&#123;</span><br><span class="line">File.Delete(newpath);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> path;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 图片水印位置处理方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>水印位置 <span class="doctag">///</span>需要添加水印的图片 <span class="doctag">///</span>水印图片 private static ArrayList GetLocation(string location, Image img, Image waterimg)</span></span><br><span class="line">&#123;</span><br><span class="line">ArrayList loca = <span class="keyword">new</span> ArrayList();</span><br><span class="line"><span class="built_in">int</span> x = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">int</span> y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (location == <span class="string">&quot;LT&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = <span class="number">10</span>;</span><br><span class="line">y = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;T&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width / <span class="number">2</span> - waterimg.Width / <span class="number">2</span>;</span><br><span class="line">y = img.Height - waterimg.Height;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;RT&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width - waterimg.Width;</span><br><span class="line">y = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;LC&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = <span class="number">10</span>;</span><br><span class="line">y = img.Height / <span class="number">2</span> - waterimg.Height / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;C&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width / <span class="number">2</span> - waterimg.Width / <span class="number">2</span>;</span><br><span class="line">y = img.Height / <span class="number">2</span> - waterimg.Height / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;RC&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width - waterimg.Width;</span><br><span class="line">y = img.Height / <span class="number">2</span> - waterimg.Height / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;LB&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = <span class="number">10</span>;</span><br><span class="line">y = img.Height - waterimg.Height;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;B&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width / <span class="number">2</span> - waterimg.Width / <span class="number">2</span>;</span><br><span class="line">y = img.Height - waterimg.Height;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">x = img.Width - waterimg.Width;</span><br><span class="line">y = img.Height - waterimg.Height;</span><br><span class="line">&#125;</span><br><span class="line">loca.Add(x);</span><br><span class="line">loca.Add(y);</span><br><span class="line"><span class="keyword">return</span> loca;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 文字水印</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 文字水印处理方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>图片路径（绝对路径） <span class="doctag">///</span>字体大小 <span class="doctag">///</span>水印文字 <span class="doctag">///</span>颜色 <span class="doctag">///</span>水印位置 public static string LetterWatermark(string path, int size, string letter, Color color, string location)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">region</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> kz_name = Path.GetExtension(path);</span><br><span class="line"><span class="keyword">if</span> (kz_name == <span class="string">&quot;.jpg&quot;</span> || kz_name == <span class="string">&quot;.bmp&quot;</span> || kz_name == <span class="string">&quot;.jpeg&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">DateTime time = DateTime.Now;</span><br><span class="line"><span class="built_in">string</span> filename = <span class="string">&quot;&quot;</span> + time.Year.ToString() + time.Month.ToString() + time.Day.ToString() + time.Hour.ToString() + time.Minute.ToString() + time.Second.ToString() + time.Millisecond.ToString();</span><br><span class="line">Image img = Bitmap.FromFile(path);</span><br><span class="line">Graphics gs = Graphics.FromImage(img);</span><br><span class="line">ArrayList loca = GetLocation(location, img, size, letter.Length);</span><br><span class="line">Font font = <span class="keyword">new</span> Font(<span class="string">&quot;宋体&quot;</span>, size);</span><br><span class="line">Brush br = <span class="keyword">new</span> SolidBrush(color);</span><br><span class="line">gs.DrawString(letter, font, br, <span class="built_in">float</span>.Parse(loca[<span class="number">0</span>].ToString()), <span class="built_in">float</span>.Parse(loca[<span class="number">1</span>].ToString()));</span><br><span class="line">gs.Dispose();</span><br><span class="line"><span class="built_in">string</span> newpath = Path.GetDirectoryName(path) + filename + kz_name;</span><br><span class="line">img.Save(newpath);</span><br><span class="line">img.Dispose();</span><br><span class="line">File.Copy(newpath, path, <span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (File.Exists(newpath))</span><br><span class="line">&#123;</span><br><span class="line">File.Delete(newpath);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> path;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 文字水印位置的方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>位置代码 <span class="doctag">///</span>图片对象 <span class="doctag">///</span>宽(当水印类型为文字时,传过来的就是字体的大小) <span class="doctag">///</span>高(当水印类型为文字时,传过来的就是字符的长度) private static ArrayList GetLocation(string location, Image img, int width, int height)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">region</span></span></span><br><span class="line"></span><br><span class="line">ArrayList loca = <span class="keyword">new</span> ArrayList();  <span class="comment">//定义数组存储位置</span></span><br><span class="line"><span class="built_in">float</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">float</span> y = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (location == <span class="string">&quot;LT&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">loca.Add(x);</span><br><span class="line">loca.Add(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;T&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width / <span class="number">2</span> - (width * height) / <span class="number">2</span>;</span><br><span class="line">loca.Add(x);</span><br><span class="line">loca.Add(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;RT&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width - width * height;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;LC&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">y = img.Height / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;C&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width / <span class="number">2</span> - (width * height) / <span class="number">2</span>;</span><br><span class="line">y = img.Height / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;RC&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width - height;</span><br><span class="line">y = img.Height / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;LB&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">y = img.Height - width - <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (location == <span class="string">&quot;B&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = img.Width / <span class="number">2</span> - (width * height) / <span class="number">2</span>;</span><br><span class="line">y = img.Height - width - <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">x = img.Width - width * height;</span><br><span class="line">y = img.Height - width - <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line">loca.Add(x);</span><br><span class="line">loca.Add(y);</span><br><span class="line"><span class="keyword">return</span> loca;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 调整光暗</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 调整光暗</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原始图片 <span class="doctag">///</span>原始图片的长度 <span class="doctag">///</span>原始图片的高度 <span class="doctag">///</span>增加或减少的光暗值 public Bitmap LDPic(Bitmap mybm, int width, int height, int val)</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap bm = <span class="keyword">new</span> Bitmap(width, height);<span class="comment">//初始化一个记录经过处理后的图片对象</span></span><br><span class="line"><span class="built_in">int</span> x, y, resultR, resultG, resultB;<span class="comment">//x、y是循环次数，后面三个是记录红绿蓝三个值的</span></span><br><span class="line">Color pixel;</span><br><span class="line"><span class="keyword">for</span> (x = <span class="number">0</span>; x &amp;lt; width; x++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (y = <span class="number">0</span>; y &amp;lt; height; y++)</span><br><span class="line">&#123;</span><br><span class="line">pixel = mybm.GetPixel(x, y);<span class="comment">//获取当前像素的值</span></span><br><span class="line">resultR = pixel.R + val;<span class="comment">//检查红色值会不会超出[0, 255]</span></span><br><span class="line">resultG = pixel.G + val;<span class="comment">//检查绿色值会不会超出[0, 255]</span></span><br><span class="line">resultB = pixel.B + val;<span class="comment">//检查蓝色值会不会超出[0, 255]</span></span><br><span class="line">bm.SetPixel(x, y, Color.FromArgb(resultR, resultG, resultB));<span class="comment">//绘图</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 反色处理</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 反色处理</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原始图片 <span class="doctag">///</span>原始图片的长度 <span class="doctag">///</span>原始图片的高度 public Bitmap RePic(Bitmap mybm, int width, int height)</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap bm = <span class="keyword">new</span> Bitmap(width, height);<span class="comment">//初始化一个记录处理后的图片的对象</span></span><br><span class="line"><span class="built_in">int</span> x, y, resultR, resultG, resultB;</span><br><span class="line">Color pixel;</span><br><span class="line"><span class="keyword">for</span> (x = <span class="number">0</span>; x &amp;lt; width; x++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (y = <span class="number">0</span>; y &amp;lt; height; y++)</span><br><span class="line">&#123;</span><br><span class="line">pixel = mybm.GetPixel(x, y);<span class="comment">//获取当前坐标的像素值</span></span><br><span class="line">resultR = <span class="number">255</span> - pixel.R;<span class="comment">//反红</span></span><br><span class="line">resultG = <span class="number">255</span> - pixel.G;<span class="comment">//反绿</span></span><br><span class="line">resultB = <span class="number">255</span> - pixel.B;<span class="comment">//反蓝</span></span><br><span class="line">bm.SetPixel(x, y, Color.FromArgb(resultR, resultG, resultB));<span class="comment">//绘图</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 浮雕处理</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 浮雕处理</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原始图片 <span class="doctag">///</span>原始图片的长度 <span class="doctag">///</span>原始图片的高度 public Bitmap FD(Bitmap oldBitmap, int Width, int Height)</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap newBitmap = <span class="keyword">new</span> Bitmap(Width, Height);</span><br><span class="line">Color color1, color2;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> x = <span class="number">0</span>; x &amp;lt; Width - <span class="number">1</span>; x++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> y = <span class="number">0</span>; y &amp;lt; Height - <span class="number">1</span>; y++) &#123; <span class="built_in">int</span> r = <span class="number">0</span>, g = <span class="number">0</span>, b = <span class="number">0</span>; color1 = oldBitmap.GetPixel(x, y); color2 = oldBitmap.GetPixel(x + <span class="number">1</span>, y + <span class="number">1</span>); r = Math.Abs(color1.R - color2.R + <span class="number">128</span>); g = Math.Abs(color1.G - color2.G + <span class="number">128</span>); b = Math.Abs(color1.B - color2.B + <span class="number">128</span>); <span class="keyword">if</span> (r &amp;gt; <span class="number">255</span>) r = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">if</span> (r &amp;lt; <span class="number">0</span>) r = <span class="number">0</span>; <span class="keyword">if</span> (g &amp;gt; <span class="number">255</span>) g = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">if</span> (g &amp;lt; <span class="number">0</span>) g = <span class="number">0</span>; <span class="keyword">if</span> (b &amp;gt; <span class="number">255</span>) b = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">if</span> (b &amp;lt; <span class="number">0</span>) b = <span class="number">0</span>;</span><br><span class="line">newBitmap.SetPixel(x, y, Color.FromArgb(r, g, b));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> newBitmap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 拉伸图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 拉伸图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原始图片 <span class="doctag">///</span>新的宽度 <span class="doctag">///</span>新的高度 public static Bitmap ResizeImage(Bitmap bmp, int newW, int newH)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap bap = <span class="keyword">new</span> Bitmap(newW, newH);</span><br><span class="line">Graphics g = Graphics.FromImage(bap);</span><br><span class="line">g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;</span><br><span class="line">g.DrawImage(bap, <span class="keyword">new</span> Rectangle(<span class="number">0</span>, <span class="number">0</span>, newW, newH), <span class="keyword">new</span> Rectangle(<span class="number">0</span>, <span class="number">0</span>, bap.Width, bap.Height), GraphicsUnit.Pixel);</span><br><span class="line">g.Dispose();</span><br><span class="line"><span class="keyword">return</span> bap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 滤色处理</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 滤色处理</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原始图片 <span class="doctag">///</span>原始图片的长度 <span class="doctag">///</span>原始图片的高度 public Bitmap FilPic(Bitmap mybm, int width, int height)</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap bm = <span class="keyword">new</span> Bitmap(width, height);<span class="comment">//初始化一个记录滤色效果的图片对象</span></span><br><span class="line"><span class="built_in">int</span> x, y;</span><br><span class="line">Color pixel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (x = <span class="number">0</span>; x &amp;lt; width; x++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (y = <span class="number">0</span>; y &amp;lt; height; y++)</span><br><span class="line">&#123;</span><br><span class="line">pixel = mybm.GetPixel(x, y);<span class="comment">//获取当前坐标的像素值</span></span><br><span class="line">bm.SetPixel(x, y, Color.FromArgb(<span class="number">0</span>, pixel.G, pixel.B));<span class="comment">//绘图</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 左右翻转</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 左右翻转</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原始图片 <span class="doctag">///</span>原始图片的长度 <span class="doctag">///</span>原始图片的高度 public Bitmap RevPicLR(Bitmap mybm, int width, int height)</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap bm = <span class="keyword">new</span> Bitmap(width, height);</span><br><span class="line"><span class="built_in">int</span> x, y, z; <span class="comment">//x,y是循环次数,z是用来记录像素点的x坐标的变化的</span></span><br><span class="line">Color pixel;</span><br><span class="line"><span class="keyword">for</span> (y = height - <span class="number">1</span>; y &amp;gt;= <span class="number">0</span>; y--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (x = width - <span class="number">1</span>, z = <span class="number">0</span>; x &amp;gt;= <span class="number">0</span>; x--)</span><br><span class="line">&#123;</span><br><span class="line">pixel = mybm.GetPixel(x, y);<span class="comment">//获取当前像素的值</span></span><br><span class="line">bm.SetPixel(z++, y, Color.FromArgb(pixel.R, pixel.G, pixel.B));<span class="comment">//绘图</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 上下翻转</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 上下翻转</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原始图片 <span class="doctag">///</span>原始图片的长度 <span class="doctag">///</span>原始图片的高度 public Bitmap RevPicUD(Bitmap mybm, int width, int height)</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap bm = <span class="keyword">new</span> Bitmap(width, height);</span><br><span class="line"><span class="built_in">int</span> x, y, z;</span><br><span class="line">Color pixel;</span><br><span class="line"><span class="keyword">for</span> (x = <span class="number">0</span>; x &amp;lt; width; x++) &#123; <span class="keyword">for</span> (y = height - <span class="number">1</span>, z = <span class="number">0</span>; y &amp;gt;= <span class="number">0</span>; y--)</span><br><span class="line">&#123;</span><br><span class="line">pixel = mybm.GetPixel(x, y);<span class="comment">//获取当前像素的值</span></span><br><span class="line">bm.SetPixel(x, z++, Color.FromArgb(pixel.R, pixel.G, pixel.B));<span class="comment">//绘图</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 压缩图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 压缩到指定尺寸</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>原文件 <span class="doctag">///</span>新文件 public bool Compress(string oldfile, string newfile)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">System.Drawing.Image img = System.Drawing.Image.FromFile(oldfile);</span><br><span class="line">System.Drawing.Imaging.ImageFormat thisFormat = img.RawFormat;</span><br><span class="line">Size newSize = <span class="keyword">new</span> Size(<span class="number">100</span>, <span class="number">125</span>);</span><br><span class="line">Bitmap outBmp = <span class="keyword">new</span> Bitmap(newSize.Width, newSize.Height);</span><br><span class="line">Graphics g = Graphics.FromImage(outBmp);</span><br><span class="line">g.CompositingQuality = CompositingQuality.HighQuality;</span><br><span class="line">g.SmoothingMode = SmoothingMode.HighQuality;</span><br><span class="line">g.InterpolationMode = InterpolationMode.HighQualityBicubic;</span><br><span class="line">g.DrawImage(img, <span class="keyword">new</span> Rectangle(<span class="number">0</span>, <span class="number">0</span>, newSize.Width, newSize.Height), <span class="number">0</span>, <span class="number">0</span>, img.Width, img.Height, GraphicsUnit.Pixel);</span><br><span class="line">g.Dispose();</span><br><span class="line">EncoderParameters encoderParams = <span class="keyword">new</span> EncoderParameters();</span><br><span class="line"><span class="built_in">long</span>[] quality = <span class="keyword">new</span> <span class="built_in">long</span>[<span class="number">1</span>];</span><br><span class="line">quality[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">EncoderParameter encoderParam = <span class="keyword">new</span> EncoderParameter(System.Drawing.Imaging.Encoder.Quality, quality);</span><br><span class="line">encoderParams.Param[<span class="number">0</span>] = encoderParam;</span><br><span class="line">ImageCodecInfo[] arrayICI = ImageCodecInfo.GetImageEncoders();</span><br><span class="line">ImageCodecInfo jpegICI = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> x = <span class="number">0</span>; x &amp;lt; arrayICI.Length; x++)</span><br><span class="line"><span class="keyword">if</span> (arrayICI[x].FormatDescription.Equals(<span class="string">&quot;JPEG&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">jpegICI = arrayICI[x]; <span class="comment">//设置JPEG编码</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">img.Dispose();</span><br><span class="line"><span class="keyword">if</span> (jpegICI != <span class="literal">null</span>) outBmp.Save(newfile, System.Drawing.Imaging.ImageFormat.Jpeg);</span><br><span class="line">outBmp.Dispose();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 图片灰度化</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Color <span class="title">Gray</span>(<span class="params">Color c</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span> rgb = Convert.ToInt32((<span class="built_in">double</span>)(((<span class="number">0.3</span> * c.R) + (<span class="number">0.59</span> * c.G)) + (<span class="number">0.11</span> * c.B)));</span><br><span class="line"><span class="keyword">return</span> Color.FromArgb(rgb, rgb, rgb);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 转换为黑白图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 转换为黑白图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>要进行处理的图片 <span class="doctag">///</span>图片的长度 <span class="doctag">///</span>图片的高度 public Bitmap BWPic(Bitmap mybm, int width, int height)</span></span><br><span class="line">&#123;</span><br><span class="line">Bitmap bm = <span class="keyword">new</span> Bitmap(width, height);</span><br><span class="line"><span class="built_in">int</span> x, y, result; <span class="comment">//x,y是循环次数，result是记录处理后的像素值</span></span><br><span class="line">Color pixel;</span><br><span class="line"><span class="keyword">for</span> (x = <span class="number">0</span>; x &amp;lt; width; x++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (y = <span class="number">0</span>; y &amp;lt; height; y++)</span><br><span class="line">&#123;</span><br><span class="line">pixel = mybm.GetPixel(x, y);<span class="comment">//获取当前坐标的像素值</span></span><br><span class="line">result = (pixel.R + pixel.G + pixel.B) / <span class="number">3</span>;<span class="comment">//取红绿蓝三色的平均值</span></span><br><span class="line">bm.SetPixel(x, y, Color.FromArgb(result, result, result));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 获取图片中的各帧</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取图片中的各帧</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>图片路径 <span class="doctag">///</span>保存路径 public void GetFrames(string pPath, string pSavedPath)</span></span><br><span class="line">&#123;</span><br><span class="line">Image gif = Image.FromFile(pPath);</span><br><span class="line">FrameDimension fd = <span class="keyword">new</span> FrameDimension(gif.FrameDimensionsList[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">int</span> count = gif.GetFrameCount(fd); <span class="comment">//获取帧数(gif图片可能包含多帧，其它格式图片一般仅一帧)</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &amp;lt; count; i++)    <span class="comment">//以Jpeg格式保存各帧</span></span><br><span class="line">&#123;</span><br><span class="line">gif.SelectActiveFrame(fd, i);</span><br><span class="line">gif.Save(pSavedPath + <span class="string">&quot;\\frame_&quot;</span> + i + <span class="string">&quot;.jpg&quot;</span>, ImageFormat.Jpeg);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;方法介绍：&quot;&gt;&lt;a href=&quot;#方法介绍：&quot; class=&quot;headerlink&quot; title=&quot;方法介绍：&quot;&gt;&lt;/a&gt;方法介绍：&lt;/h2&gt;&lt;ul&gt;
     &lt;li&gt;生成缩略图&lt;/li&gt;
     &lt;li&gt;图片水印处理方法&lt;/li&gt;
     &lt;li&gt;图片水印位置处理方法&lt;/li&gt;
     &lt;li&gt;文字水印处理方法&lt;/li&gt;
     &lt;li&gt;文字水印位置的方法&lt;/li&gt;
     &lt;li&gt;调整光暗&lt;/li&gt;
     &lt;li&gt;反色处理&lt;/li&gt;
     &lt;li&gt;浮雕处理&lt;/li&gt;
     &lt;li&gt;拉伸图片&lt;/li&gt;
     &lt;li&gt;滤色处理&lt;/li&gt;
     &lt;li&gt;左右翻转&lt;/li&gt;
     &lt;li&gt;上下翻转&lt;/li&gt;
     &lt;li&gt;压缩到指定尺寸&lt;/li&gt;
     &lt;li&gt;转换为黑白图片&lt;/li&gt;
     &lt;li&gt;获取图片中的各帧&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>JSON序列化和JSON反序列化和ajax一直返回error的解决方案</title>
    <link href="https://kdt-g.github.io/2020/08/12/-sBSOb8Xu/"/>
    <id>https://kdt-g.github.io/2020/08/12/-sBSOb8Xu/</id>
    <published>2020-08-12T14:10:13.000Z</published>
    <updated>2022-03-26T16:53:36.352Z</updated>
    
    <content type="html"><![CDATA[<p>一、JSON.stringify()序列化和JSON.parse()反序列化</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> K = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data);<span class="comment">//JSON.stringify() 将JavaScript 对象转换为 JSON 字符</span></span><br><span class="line"><span class="title function_">alert</span>(K);</span><br><span class="line"><span class="keyword">var</span> data1 = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;chunlynn&quot; ,&quot;age&quot;: 27, &quot;sex&quot;: &quot;man&quot; ,&quot;qq&quot;:&quot;277539687&quot;&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Kx</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(K);<span class="comment">//JSON.parse()将JSON字符串转为一个对象</span></span><br><span class="line">layer.<span class="title function_">alert</span>(<span class="title class_">Kx</span>[<span class="number">0</span>][<span class="string">&#x27;id&#x27;</span>] + <span class="title class_">Kx</span>[<span class="number">0</span>][<span class="string">&#x27;username&#x27;</span>]);</span><br></pre></td></tr></table></figure><span id="more"></span><p>二、ajax的注意事项</p><blockquote><p>简单来说就是，在用ajax提交数据后，获取返回的结果，一定要保证后台返回时，尽量全部代码在异常处理代码中，设置出现异常返回提醒或者其他东西，不然一旦你一点代码出问题，哪怕接收的参数处理出现问题，ajax都会因为得不到后台处理该异常，一直返回error</p></blockquote><p>前台：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">                    <span class="comment">//几个参数需要注意一下</span></span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&quot;post&quot;</span>,<span class="comment">//方法类型</span></span><br><span class="line">                    <span class="attr">url</span>: <span class="string">&quot;/Home/Add/&quot;</span>,<span class="comment">//url</span></span><br><span class="line">                    <span class="attr">data</span>: &#123; <span class="string">&quot;json&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data.<span class="property">field</span>) &#125;,</span><br><span class="line">                    <span class="attr">dataType</span>: <span class="string">&#x27;text&#x27;</span>,</span><br><span class="line">                    <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(result);<span class="comment">//打印服务端返回的数据(调试用)</span></span><br><span class="line">                        <span class="keyword">if</span> (<span class="string">&quot;&quot;</span> != result) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (index == <span class="literal">null</span>) &#123;</span><br><span class="line">                                <span class="title function_">alert</span>(<span class="string">&#x27;失败，失败原因：&#x27;</span> + result);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> &#123;</span><br><span class="line">                            parent.<span class="property">layer</span>.<span class="title function_">msg</span>(<span class="string">&#x27;失败，失败原因：&#x27;</span> + result, &#123; <span class="attr">time</span>: <span class="number">1000</span>,<span class="attr">shade</span>: <span class="number">0.3</span> &#125;)</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (index == <span class="literal">null</span>) &#123;</span><br><span class="line">                                <span class="title function_">alert</span>(<span class="string">&#x27;添加成功&#x27;</span> + result)</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> &#123;</span><br><span class="line">                                parent.<span class="property">layer</span>.<span class="title function_">msg</span>(<span class="string">&#x27;添加成功&#x27;</span> + result, &#123; <span class="attr">time</span>: <span class="number">1000</span>, <span class="attr">shade</span>: <span class="number">0.3</span> &#125;)</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                           <span class="comment">// window.location.replace(&quot;AddPage&quot;);</span></span><br><span class="line">                            <span class="comment">//同步更新表格和缓存对应的值 </span></span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (index == <span class="literal">null</span>) &#123;</span><br><span class="line">                            <span class="title function_">alert</span>(<span class="string">&#x27;请稍后再试&#x27;</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            parent.<span class="property">layer</span>.<span class="title function_">msg</span>(<span class="string">&#x27;请稍后再试&#x27;</span>, &#123; <span class="attr">time</span>: <span class="number">1000</span>, <span class="attr">shade</span>: <span class="number">0.3</span> &#125;)</span><br><span class="line">                        &#125;                </span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br></pre></td></tr></table></figure><p>后台：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 添加</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Add</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> bug = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span>  <span class="comment">//一定要加这个</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span> json = Request.Form[<span class="string">&quot;json&quot;</span>];</span><br><span class="line">           Newtonsoft.Json.Linq.JObject jobject =<span class="comment">//这里解析出问题也会报错，可以建个新页面测试功能，查找bug</span></span><br><span class="line">                   (Newtonsoft.Json.Linq.JObject)Newtonsoft.Json.JsonConvert.DeserializeObject(json);</span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> name = jobject[<span class="string">&quot;username&quot;</span>].ToString();</span><br><span class="line">                <span class="built_in">string</span> sex = jobject[<span class="string">&quot;sex&quot;</span>].ToString();</span><br><span class="line">                <span class="built_in">string</span> Province = jobject[<span class="string">&quot;Province&quot;</span>].ToString();</span><br><span class="line">                <span class="built_in">string</span> City = jobject[<span class="string">&quot;City&quot;</span>].ToString();</span><br><span class="line">                <span class="built_in">string</span> Counties = jobject[<span class="string">&quot;Counties&quot;</span>].ToString();<span class="comment">//就像我这里出了问题一直报错</span></span><br><span class="line">                <span class="built_in">string</span> Sign = jobject[<span class="string">&quot;Sign&quot;</span>].ToString();</span><br><span class="line">                <span class="built_in">int</span> Experience = Convert.ToInt32(jobject[<span class="string">&quot;Experience&quot;</span>]);</span><br><span class="line">                <span class="built_in">int</span> Score = Convert.ToInt32(jobject[<span class="string">&quot;Score&quot;</span>]); ;</span><br><span class="line">                <span class="built_in">int</span> Classify = Convert.ToInt32(jobject[<span class="string">&quot;Classify&quot;</span>]);</span><br><span class="line">             </span><br><span class="line">                <span class="keyword">if</span> (SQL.Add(name, sex, Province, City, Counties, Sign, Experience, Score, Classify, <span class="keyword">out</span> bug))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> bug;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> bug;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception)</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;检查表单格式&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;一、JSON.stringify()序列化和JSON.parse()反序列化&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; K = &lt;span class=&quot;title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;title function_&quot;&gt;stringify&lt;/span&gt;(data);&lt;span class=&quot;comment&quot;&gt;//JSON.stringify() 将JavaScript 对象转换为 JSON 字符&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title function_&quot;&gt;alert&lt;/span&gt;(K);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; data1 = &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;&amp;quot;name&amp;quot;:&amp;quot;chunlynn&amp;quot; ,&amp;quot;age&amp;quot;: 27, &amp;quot;sex&amp;quot;: &amp;quot;man&amp;quot; ,&amp;quot;qq&amp;quot;:&amp;quot;277539687&amp;quot;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Kx&lt;/span&gt; = &lt;span class=&quot;title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;title function_&quot;&gt;parse&lt;/span&gt;(K);&lt;span class=&quot;comment&quot;&gt;//JSON.parse()将JSON字符串转为一个对象&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;layer.&lt;span class=&quot;title function_&quot;&gt;alert&lt;/span&gt;(&lt;span class=&quot;title class_&quot;&gt;Kx&lt;/span&gt;[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;string&quot;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;] + &lt;span class=&quot;title class_&quot;&gt;Kx&lt;/span&gt;[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;string&quot;&gt;&amp;#x27;username&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="前端" scheme="https://kdt-g.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="javascript" scheme="https://kdt-g.github.io/tags/javascript/"/>
    
    <category term="html" scheme="https://kdt-g.github.io/tags/html/"/>
    
    <category term="Json" scheme="https://kdt-g.github.io/tags/Json/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
    <category term="mvc" scheme="https://kdt-g.github.io/tags/mvc/"/>
    
  </entry>
  
  <entry>
    <title>c#压缩图片</title>
    <link href="https://kdt-g.github.io/2020/07/16/FkjvP9E8C/"/>
    <id>https://kdt-g.github.io/2020/07/16/FkjvP9E8C/</id>
    <published>2020-07-16T01:14:11.000Z</published>
    <updated>2022-03-26T17:07:35.811Z</updated>
    
    <content type="html"><![CDATA[<h2 id="代码如下："><a href="#代码如下：" class="headerlink" title="代码如下："></a>代码如下：</h2><span id="more"></span><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> System.Drawing.Imaging;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Net;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Image_Compression</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Image_Compression</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&amp;nbsp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//原图片路径</span></span><br><span class="line"><span class="built_in">string</span> OldImgPath = <span class="string">@&quot;C:\Users\98468\Desktop\tu\&quot;</span>;</span><br><span class="line"><span class="comment">//保存压缩后图片路径</span></span><br><span class="line"><span class="built_in">string</span> NewImgPath = <span class="string">@&quot;C:\Users\98468\Desktop\su\&quot;</span>;</span><br><span class="line"><span class="comment">//压缩质量（数字越小压缩率越高）1-100</span></span><br><span class="line"><span class="built_in">int</span> ImgQuality = <span class="number">90</span>;</span><br><span class="line"><span class="comment">//压缩图片最大大小</span></span><br><span class="line"><span class="built_in">int</span> ImgSize = <span class="number">200</span>;</span><br><span class="line"><span class="comment">//最大分辨率高 默认是0</span></span><br><span class="line"><span class="built_in">int</span> resolution_Max_H = <span class="number">1024</span>;</span><br><span class="line"><span class="comment">//最大分辨率宽 默认是0</span></span><br><span class="line"><span class="built_in">int</span> resolution_Max_W = <span class="number">1024</span>;</span><br><span class="line"><span class="comment">//调用压缩图片方法</span></span><br><span class="line">Image_Compression_Main(OldImgPath, NewImgPath, ImgSize, ImgQuality, resolution_Max_H, resolution_Max_W);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 压缩图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;/summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;OldImgPath&quot;&amp;gt;原图片路径&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;NewImgPath&quot;&amp;gt;保存压缩后图片路径&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;ImgSize&quot;&amp;gt;压缩图片最大大小&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;ImgQuality&quot;&amp;gt;压缩质量（数字越小压缩率越高）1-100&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;resolution_Max_H&quot;&amp;gt;最大分辨率高 默认是0&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;resolution_Max_W&quot;&amp;gt;最大分辨率宽 默认是0&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Image_Compression_Main</span>(<span class="params"><span class="built_in">string</span> OldImgPath, <span class="built_in">string</span> NewImgPath, <span class="built_in">int</span> ImgSize, <span class="built_in">int</span> ImgQuality = <span class="number">90</span>, <span class="built_in">int</span> resolution_Max_H = <span class="number">0</span>, <span class="built_in">int</span> resolution_Max_W = <span class="number">0</span></span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//获取图片文件路径</span></span><br><span class="line">DirectoryInfo path = <span class="keyword">new</span> DirectoryInfo(OldImgPath);</span><br><span class="line"><span class="comment">//遍历指定路径目录下文件</span></span><br><span class="line"><span class="keyword">foreach</span> (FileInfo File <span class="keyword">in</span> path.GetFiles())</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//规定输入文件格式</span></span><br><span class="line"><span class="keyword">if</span> (File.Extension == <span class="string">&quot;.Png&quot;</span> || File.Extension == <span class="string">&quot;.png&quot;</span> || File.Extension == <span class="string">&quot;.Jpg&quot;</span> || File.Extension == <span class="string">&quot;.jpg&quot;</span> || File.Extension == <span class="string">&quot;.JPEG&quot;</span> || File.Extension == <span class="string">&quot;.jpeg&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//分辨率处理</span></span><br><span class="line"><span class="built_in">int</span> resolution_Min_Multiple = <span class="number">2</span>;</span><br><span class="line"><span class="comment">//拼接具体的文件路径</span></span><br><span class="line"><span class="built_in">string</span> FilePath = OldImgPath + File.Name;</span><br><span class="line"><span class="comment">//文件大小</span></span><br><span class="line"><span class="built_in">double</span> FileSize = GetFileSize(FilePath);</span><br><span class="line">Console.WriteLine(FileSize);</span><br><span class="line"><span class="keyword">if</span> (<span class="number">1</span> - FileSize &amp;lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ((<span class="number">1</span> - (FileSize / <span class="number">100</span>))<span class="number">-1</span> &amp;lt; <span class="number">-10</span>)<span class="comment">//1000MB之外</span></span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">$@&quot;图片:&#x27;<span class="subst">&#123;FilePath&#125;</span>&#x27;太大了！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ((<span class="number">1</span> - (FileSize / <span class="number">100</span>)) &amp;lt;= <span class="number">0</span> &amp;amp;&amp;amp; (<span class="number">1</span> - (FileSize / <span class="number">100</span>))<span class="number">-1</span> &amp;gt; <span class="number">-10</span>)<span class="comment">//1000MB之内</span></span><br><span class="line">&#123;</span><br><span class="line">resolution_Min_Multiple = <span class="number">16</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ((<span class="number">1</span> - (FileSize / <span class="number">10</span>)) &amp;lt;= <span class="number">0</span> &amp;amp;&amp;amp; (<span class="number">1</span> - (FileSize / <span class="number">10</span>))<span class="number">-1</span> &amp;gt; <span class="number">-10</span>)<span class="comment">//100以内</span></span><br><span class="line">&#123;</span><br><span class="line">resolution_Min_Multiple = <span class="number">8</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ((<span class="number">1</span> - FileSize) &amp;lt;= <span class="number">0</span> &amp;amp;&amp;amp; (<span class="number">1</span> - FileSize)<span class="number">-1</span> &amp;lt; <span class="number">-1</span>)<span class="comment">//10以内</span></span><br><span class="line">&#123;</span><br><span class="line">resolution_Min_Multiple = <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (FileSize &amp;lt; ImgSize /<span class="number">1024</span>)<span class="comment">//如果太小则不压缩直接传递</span></span><br><span class="line">&#123;</span><br><span class="line">File.CopyTo(NewImgPath+Path.GetFileNameWithoutExtension(File.Name)+<span class="string">&quot;.jpg&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">Console.WriteLine(<span class="string">$@&quot;图片:&#x27;<span class="subst">&#123;File.Name&#125;</span>&#x27;压缩完成！&quot;</span>);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断文件大小，确定是否压缩，如果大小满足则直接保存到新路径，如果不满足则进行压缩操作</span></span><br><span class="line"><span class="keyword">if</span> (CompressImage(FilePath, NewImgPath + Path.GetFileNameWithoutExtension(File.Name) + <span class="string">&quot;.jpg&quot;</span>, resolution_Max_H, resolution_Max_W, resolution_Min_Multiple, ImgQuality, ImgSize))<span class="comment">//压缩成功</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">$@&quot;图片:&#x27;<span class="subst">&#123;File.Name&#125;</span>&#x27;压缩完成！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="comment">//压缩失败</span></span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">$@&quot;图片:&#x27;<span class="subst">&#123;File.Name&#125;</span>&#x27;压缩失败！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取图片文件大小</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;/summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;path&quot;&amp;gt;图片路径&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">GetFileSize</span>(<span class="params"><span class="built_in">string</span> path</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">System.IO.FileInfo fileInfo = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">fileInfo = <span class="keyword">new</span> System.IO.FileInfo(path);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception e)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">$@&quot;获取图片<span class="subst">&#123;path&#125;</span>大小失败 Getcatch&quot;</span>);</span><br><span class="line">Console.WriteLine(e);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (fileInfo != <span class="literal">null</span> &amp;amp;&amp;amp; fileInfo.Exists)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//所得文件MB大小</span></span><br><span class="line"><span class="built_in">double</span> Length = (System.Math.Floor(fileInfo.Length / <span class="number">1024.0</span> / <span class="number">1024.0</span>) + System.Math.Floor(fileInfo.Length / <span class="number">1024.0</span> % <span class="number">1024.0</span> / <span class="number">10</span>) / <span class="number">100</span>);</span><br><span class="line"><span class="keyword">if</span> (Length &amp;gt; <span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> Length;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">$@&quot;获取图片<span class="subst">&#123;path&#125;</span>大小失败 Getelse&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 无损压缩图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;/summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;sFile&quot;&amp;gt;原图片地址&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;dFile&quot;&amp;gt;保存压缩后图片路径&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;resolution_Max_H&quot;&amp;gt;最大分辨率高&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;resolution_Max_W&quot;&amp;gt;最大分辨率宽&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;resolution_Min_Multiple&quot;&amp;gt;分辨率缩小倍数&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;flag&quot;&amp;gt;压缩质量（数字越小压缩率越高）1-100&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;size&quot;&amp;gt;压缩后图片的最大大小&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">CompressImage</span>(<span class="params"><span class="built_in">string</span> sFile, <span class="built_in">string</span> dFile, <span class="built_in">int</span> resolution_Max_H = <span class="number">0</span>, <span class="built_in">int</span> resolution_Max_W = <span class="number">0</span>, <span class="built_in">int</span> resolution_Min_Multiple = <span class="number">1</span>, <span class="built_in">int</span> flag = <span class="number">90</span>, <span class="built_in">int</span> size = <span class="number">300</span></span>)</span></span><br><span class="line">&#123;</span><br><span class="line">Image iSource = Image.FromFile(sFile);</span><br><span class="line">ImageFormat tFormat = iSource.RawFormat;</span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 旧代码</span></span><br><span class="line"><span class="comment">//设置图片高宽</span></span><br><span class="line"><span class="built_in">int</span> dHeight = iSource.Height / resolution_Min_Multiple;<span class="comment">//分辨率高度</span></span><br><span class="line"><span class="built_in">int</span> dWidth = iSource.Width / resolution_Min_Multiple; <span class="comment">//分辨率宽度</span></span><br><span class="line"><span class="comment">//判断是否为手动设置最大分辨率高宽</span></span><br><span class="line"><span class="comment">//判断处理后的分辨率高度是否大于手动设置的分辨率高度,如果大于则设置为指定高度</span></span><br><span class="line"><span class="keyword">if</span> (resolution_Max_H != <span class="number">0</span> &amp;amp;&amp;amp; iSource.Height / resolution_Min_Multiple &amp;gt; resolution_Max_H)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//赋值为手动设置的分辨率的高</span></span><br><span class="line">dHeight = resolution_Max_H;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断处理后的分辨率宽度是否大于手动设置的分辨率宽度，如果大于则设置为指定宽度</span></span><br><span class="line"><span class="keyword">if</span> (resolution_Max_W != <span class="number">0</span> &amp;amp;&amp;amp; iSource.Width / resolution_Min_Multiple &amp;gt; resolution_Max_W)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//赋值为手动设置的分辨率的宽</span></span><br><span class="line">dWidth = resolution_Max_W;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (resolution_Max_H == <span class="number">0</span> &amp;amp;&amp;amp; resolution_Max_W == <span class="number">0</span>)<span class="comment">//如果为空则继续赋值为原处理后的分辨率高宽</span></span><br><span class="line">&#123;</span><br><span class="line">dHeight = iSource.Height / resolution_Min_Multiple;<span class="comment">//分辨率高度</span></span><br><span class="line">dWidth = iSource.Width / resolution_Min_Multiple; <span class="comment">//分辨率宽度</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">&amp;nbsp;</span><br><span class="line"></span><br><span class="line">Bitmap ob = <span class="keyword">new</span> Bitmap(dWidth, dHeight);</span><br><span class="line">Graphics g = Graphics.FromImage(ob);</span><br><span class="line"></span><br><span class="line">g.Clear(Color.WhiteSmoke);</span><br><span class="line">g.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;</span><br><span class="line">g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;</span><br><span class="line">g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;</span><br><span class="line"><span class="comment">//绘制图片</span></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> 旧代码</span></span><br><span class="line">g.DrawImage(iSource, <span class="keyword">new</span> Rectangle(<span class="number">0</span>, <span class="number">0</span>, dWidth, dHeight), <span class="number">0</span>, <span class="number">0</span>, iSource.Width, iSource.Height, GraphicsUnit.Pixel);</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">g.Dispose();</span><br><span class="line"></span><br><span class="line"><span class="comment">//以下代码为保存图片时，设置压缩质量</span></span><br><span class="line">EncoderParameters ep = <span class="keyword">new</span> EncoderParameters();</span><br><span class="line"><span class="built_in">long</span>[] qy = <span class="keyword">new</span> <span class="built_in">long</span>[<span class="number">1</span>];</span><br><span class="line">qy[<span class="number">0</span>] = flag;<span class="comment">//设置压缩的比例1-100</span></span><br><span class="line">EncoderParameter eParam = <span class="keyword">new</span> EncoderParameter(System.Drawing.Imaging.Encoder.Quality, qy);</span><br><span class="line">ep.Param[<span class="number">0</span>] = eParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">ImageCodecInfo[] arrayICI = ImageCodecInfo.GetImageEncoders();</span><br><span class="line">ImageCodecInfo jpegICIinfo = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> x = <span class="number">0</span>; x &amp;lt; arrayICI.Length; x++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arrayICI[x].FormatDescription.Equals(<span class="string">&quot;JPEG&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">jpegICIinfo = arrayICI[x];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (jpegICIinfo != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">ob.Save(dFile, jpegICIinfo, ep);<span class="comment">//dFile是压缩后的新路径</span></span><br><span class="line">FileInfo fi = <span class="keyword">new</span> FileInfo(dFile);</span><br><span class="line"><span class="keyword">if</span> (fi.Length &amp;gt; <span class="number">1024</span> * size)</span><br><span class="line">&#123;</span><br><span class="line">flag = flag - <span class="number">10</span>;</span><br><span class="line">CompressImage(sFile, dFile, resolution_Max_H, resolution_Max_W, resolution_Min_Multiple, flag, size);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">ob.Save(dFile, tFormat);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(ex.Message + <span class="string">&quot;,堆栈:&quot;</span> + ex.StackTrace + <span class="string">&quot;InnerException:&quot;</span> + ex.InnerException);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">&#123;</span><br><span class="line">iSource.Dispose();</span><br><span class="line">ob.Dispose();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&amp;nbsp;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&amp;nbsp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main1</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> pathPerc = <span class="string">@&quot;C:\Users\98468\Desktop\su\1.jpg&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> source = <span class="string">@&quot;C:\Users\98468\Desktop\tu\微信图片_20200723111503.jpg&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!File.Exists(pathPerc))</span><br><span class="line">&#123;</span><br><span class="line">File.Create(pathPerc).Close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">File.Delete(pathPerc);</span><br><span class="line">File.Create(pathPerc).Close();</span><br><span class="line">&#125;</span><br><span class="line">getThumImage(source, <span class="number">50</span>, <span class="number">2</span>, pathPerc);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">region</span> getThumImage</span></span><br><span class="line"><span class="comment">/**/</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 生成缩略图</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;/summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;sourceFile&quot;&amp;gt;原始图片文件&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;quality&quot;&amp;gt;质量压缩比&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;multiple&quot;&amp;gt;收缩倍数&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;param name=&quot;outputFile&quot;&amp;gt;输出文件名&amp;lt;/param&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;returns&amp;gt;成功返回true,失败则返回false&amp;lt;/returns&amp;gt;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">getThumImage</span>(<span class="params">String sourceFile, <span class="built_in">long</span> quality, <span class="built_in">int</span> multiple, String outputFile</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">long</span> imageQuality = quality;</span><br><span class="line">Bitmap sourceImage = <span class="keyword">new</span> Bitmap(sourceFile);</span><br><span class="line">ImageCodecInfo myImageCodecInfo = GetEncoderInfo(<span class="string">&quot;image/jpeg&quot;</span>);</span><br><span class="line">System.Drawing.Imaging.Encoder myEncoder = System.Drawing.Imaging.Encoder.Quality;</span><br><span class="line">EncoderParameters myEncoderParameters = <span class="keyword">new</span> EncoderParameters(<span class="number">1</span>);</span><br><span class="line">EncoderParameter myEncoderParameter = <span class="keyword">new</span> EncoderParameter(myEncoder, imageQuality);</span><br><span class="line">myEncoderParameters.Param[<span class="number">0</span>] = myEncoderParameter;</span><br><span class="line"><span class="built_in">float</span> xWidth = sourceImage.Width;</span><br><span class="line"><span class="built_in">float</span> yWidth = sourceImage.Height;</span><br><span class="line">Bitmap newImage = <span class="keyword">new</span> Bitmap((<span class="built_in">int</span>)(xWidth / multiple), (<span class="built_in">int</span>)(yWidth / multiple));</span><br><span class="line">Graphics g = Graphics.FromImage(newImage);</span><br><span class="line"></span><br><span class="line">g.DrawImage(sourceImage, <span class="number">0</span>, <span class="number">0</span>, xWidth / multiple, yWidth / multiple);</span><br><span class="line">g.Dispose();</span><br><span class="line">newImage.Save(outputFile, myImageCodecInfo, myEncoderParameters);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span> getThumImage</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**/</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;summary&amp;gt;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取图片编码信息</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> &amp;lt;/summary&amp;gt;</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ImageCodecInfo <span class="title">GetEncoderInfo</span>(<span class="params">String mimeType</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span> j;</span><br><span class="line">ImageCodecInfo[] encoders;</span><br><span class="line">encoders = ImageCodecInfo.GetImageEncoders();</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &amp;lt; encoders.Length; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (encoders[j].MimeType == mimeType)</span><br><span class="line"><span class="keyword">return</span> encoders[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;代码如下：&quot;&gt;&lt;a href=&quot;#代码如下：&quot; class=&quot;headerlink&quot; title=&quot;代码如下：&quot;&gt;&lt;/a&gt;代码如下：&lt;/h2&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>c#获取图片文件大小（亦可获取其他文件大小）</title>
    <link href="https://kdt-g.github.io/2020/07/16/LkDd9fT3J/"/>
    <id>https://kdt-g.github.io/2020/07/16/LkDd9fT3J/</id>
    <published>2020-07-16T01:09:48.000Z</published>
    <updated>2022-03-26T17:11:06.568Z</updated>
    
    <content type="html"><![CDATA[<h2 id="代码如下："><a href="#代码如下：" class="headerlink" title="代码如下："></a>代码如下：</h2><span id="more"></span> <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取图片文件大小</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;path&quot;&gt;</span>图片路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">GetFileSize</span>(<span class="params"><span class="built_in">string</span> path</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    System.IO.FileInfo fileInfo = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        fileInfo = <span class="keyword">new</span> System.IO.FileInfo(path);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception e)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$@&quot;获取图片<span class="subst">&#123;path&#125;</span>大小失败 Getcatch&quot;</span>);</span><br><span class="line">        Console.WriteLine(e);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (fileInfo != <span class="literal">null</span> &amp;&amp; fileInfo.Exists)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//if ((int)System.Math.Ceiling(fileInfo.Length / 1024.0) &gt;= 1024)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    Console.WriteLine((System.Math.Floor(fileInfo.Length / 1024.0 / 1024.0) + System.Math.Floor(fileInfo.Length / 1024.0 % 1024.0/10)/100) + &quot;MB&quot;);</span></span><br><span class="line">        <span class="comment">//    return (System.Math.Floor(fileInfo.Length / 1024.0 ) );</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">// Console.WriteLine(System.Math.Ceiling(fileInfo.Length / 1024.0)+&quot;kb&quot;);</span></span><br><span class="line">        <span class="keyword">return</span> System.Math.Ceiling(fileInfo.Length / <span class="number">1024.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$@&quot;获取图片<span class="subst">&#123;path&#125;</span>大小失败 Getelse&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;代码如下：&quot;&gt;&lt;a href=&quot;#代码如下：&quot; class=&quot;headerlink&quot; title=&quot;代码如下：&quot;&gt;&lt;/a&gt;代码如下：&lt;/h2&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>C#获取pdf文档的页数</title>
    <link href="https://kdt-g.github.io/2020/07/01/nNpEgVB_z/"/>
    <id>https://kdt-g.github.io/2020/07/01/nNpEgVB_z/</id>
    <published>2020-07-01T13:14:52.000Z</published>
    <updated>2022-03-26T17:05:51.109Z</updated>
    
    <content type="html"><![CDATA[<p>[操作pdf文档]之C#判断pdf文档的页数：</p><span id="more"></span><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取pdf文档的页数</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>-1表示文件不存在<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">GetPDFofPageCount</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> count = <span class="number">-1</span>;<span class="comment">//-1表示文件不存在</span></span><br><span class="line">    <span class="keyword">if</span> (File.Exists(filePath))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (FileStream fs = <span class="keyword">new</span> FileStream(filePath, FileMode.Open, FileAccess.Read))</span><br><span class="line">        &#123;</span><br><span class="line">            StreamReader reader = <span class="keyword">new</span> StreamReader(fs);</span><br><span class="line">            <span class="comment">//从流的当前位置到末尾读取流</span></span><br><span class="line">            <span class="built_in">string</span> pdfText = reader.ReadToEnd();</span><br><span class="line">            Regex rgx = <span class="keyword">new</span> Regex(<span class="string">@&quot;/Type\s*/Page[^s]&quot;</span>);</span><br><span class="line">            MatchCollection matches = rgx.Matches(pdfText);</span><br><span class="line">            count = matches.Count;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>转自：<a href="https://blog.csdn.net/weixin_34037515/article/details/86193239">https://blog.csdn.net/weixin_34037515&#x2F;article&#x2F;details&#x2F;86193239</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;[操作pdf文档]之C#判断pdf文档的页数：&lt;/p&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>简单使用Tesseract文字识别</title>
    <link href="https://kdt-g.github.io/2020/06/12/SVJLeGHuD/"/>
    <id>https://kdt-g.github.io/2020/06/12/SVJLeGHuD/</id>
    <published>2020-06-12T09:05:48.000Z</published>
    <updated>2022-03-26T16:57:45.028Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一-简单使用Tesseract文字识别"><a href="#一-简单使用Tesseract文字识别" class="headerlink" title="一 .简单使用Tesseract文字识别"></a><strong>一 .简单使用Tesseract文字识别</strong></h2><h3 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1.创建项目"></a>1.创建项目</h3><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508142803014-674497751.png" alt="img"></p><span id="more"></span><h3 id="2-引用Tesseract-ocr库"><a href="#2-引用Tesseract-ocr库" class="headerlink" title="2.引用Tesseract-ocr库"></a>2.引用Tesseract-ocr库</h3><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508142943294-1728988883.png" alt="img"></p><h3 id="3-下载语言文件"><a href="#3-下载语言文件" class="headerlink" title="3.下载语言文件"></a>3.下载语言文件</h3><p> 下载地址 <a href="https://github.com/tesseract-ocr/tesseract/wiki/Data-Files#data-files-for-version-302">https://github.com/tesseract-ocr/tesseract/wiki/Data-Files#data-files-for-version-302</a></p><p> 目前下载中文做实验</p><p>  <img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508143507243-1565725637.png" alt="img"></p><h3 id="4-代码部分"><a href="#4-代码部分" class="headerlink" title="4.代码部分"></a>4.代码部分</h3><p>static void Main(string[] args)<br>{<br>var img &#x3D; new Bitmap(@”F:\1557288016(1).png”);  &#x2F;&#x2F;需要识别的图片</p><p>&#x2F;&#x2F;F:\test\ConsoleApp1\TesseractDemo\tessdata 为语言包存放路径</p><p>var ocr &#x3D; new TesseractEngine(@”F:\test\ConsoleApp1\TesseractDemo\tessdata”, “chi_sim”, EngineMode.Default);  &#x2F;&#x2F;使用chi_sim中文语言包做测试</p><p>var page &#x3D; ocr.Process(img);<br>Console.Write(page.GetText());<br>Console.ReadKey();</p><p>}</p><h3 id="5-运行结果"><a href="#5-运行结果" class="headerlink" title="5.运行结果"></a>5.运行结果</h3><p>图片：<img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508144840846-996649405.png" alt="img"></p><p>识别结果：<img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508144918064-616351977.png" alt="img"></p><p>6.在原图没任何处理 字库没训练下的结果识别率还不是很理想.</p><h2 id="二-使用-jTessBoxEditor-进行简单数训练"><a href="#二-使用-jTessBoxEditor-进行简单数训练" class="headerlink" title="二. 使用 jTessBoxEditor 进行简单数训练"></a><strong>二. 使用 jTessBoxEditor 进行简单数训练</strong></h2><h3 id="1-安装-jTessBoxEditor"><a href="#1-安装-jTessBoxEditor" class="headerlink" title="1.安装 jTessBoxEditor"></a>1.安装 jTessBoxEditor</h3><p> 下载jTessBoxEditor，地址<a href="https://sourceforge.net/projects/vietocr/files/jTessBoxEditor/">https://sourceforge.net/projects/vietocr/files/jTessBoxEditor/</a></p><p>  <img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508145646924-818208451.png" alt="img"></p><p>  解压后得到jTessBoxEditor</p><p>  <img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508145748768-50104443.png" alt="img"></p><h3 id="2-由于这是由Java开发的，所以要先安装JRE-这里不阐述"><a href="#2-由于这是由Java开发的，所以要先安装JRE-这里不阐述" class="headerlink" title="2.由于这是由Java开发的，所以要先安装JRE 这里不阐述"></a>2.由于这是由Java开发的，所以要先安装JRE 这里不阐述</h3><h3 id="3-准备样本图片-两个不同字体的字母"><a href="#3-准备样本图片-两个不同字体的字母" class="headerlink" title="3.准备样本图片 两个不同字体的字母"></a>3.准备样本图片 两个不同字体的字母</h3><p>  <img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508150239099-520003011.png" alt="img"></p><p>  <img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508150340652-93852914.png" alt="img"></p><h3 id="4-将图片转换成tif-tiff格式-可百度在线图片转换tiff"><a href="#4-将图片转换成tif-tiff格式-可百度在线图片转换tiff" class="headerlink" title="4.将图片转换成tif\tiff格式 可百度在线图片转换tiff**"></a>4.将图片转换成tif\tiff格式 可百度在线图片转换tiff**</h3><p>**</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508150659179-1801374647.png" alt="img"></p><h3 id="5-合并tiff样本图片"><a href="#5-合并tiff样本图片" class="headerlink" title="5.合并tiff样本图片"></a>5.合并tiff样本图片</h3><p> 刚解压的目录找到一个【train.bat】打开 jTessBoxEditor &gt;【Tools】&gt;【Merge TIFF】 打开对话框选择两个tiff样本图片</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508151139481-256332761.png" alt="img"></p><p>点击打开弹出保存合并后图片路径选择 这里我们命名为num.font.exp0.tif</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508151322410-1328446665.png" alt="img"></p><h3 id="6-生成BOX文件"><a href="#6-生成BOX文件" class="headerlink" title="6.生成BOX文件"></a>6.生成BOX文件</h3><p>由于没有设置环境变量暂时把所有样本图片放到jTessBoxEditor\tesseract-ocr 方便cmd命令</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508151701014-704583755.png" alt="img"></p><p>cmd定位到样本图片位置执行 命令：tesseract num.font.exp0.tif num.font.exp0 batch.nochop makebox 出现下面说明成功</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508151843818-17531748.png" alt="img"></p><p>语法说明</p><p>【语法】：tesseract [lang].[fontname].exp[num].tif [lang].[fontname].exp[num] batch.nochop makebox</p><p>【语法】：lang为语言名称，fontname为字体名称，num为序号；在tesseract中，一定要注意格式</p><h3 id="7-定义字符配置文件"><a href="#7-定义字符配置文件" class="headerlink" title="7.定义字符配置文件"></a>7.定义字符配置文件</h3><p>还在在jTessBoxEditor\tesseract-ocr文件夹内，新建一个文本文件，名为font_properties，删掉.txt，用记事本打开，写入内容为：</p><p>font 0 0 0 0 0</p><p> 语法说明</p><p>【语法】：<fontname> <italic> <bold> <fixed> <serif> <fraktur><br>【语法】：fontname为字体名称，italic为斜体，bold为黑体字，<br>fixed为默认字体，serif为衬线字体，fraktur德文黑字体，<br>1和0代表有和无，精细区分时可使用</p><h3 id="8-字符矫正"><a href="#8-字符矫正" class="headerlink" title="8.字符矫正"></a>8.字符矫正</h3><p>打开 jTessBoxEditor&gt;【BOX Editor】&gt; 【Open】，打开num.font.exp0.tif；矫正【Char】上的字符 每页没个样本字体蓝色框都要包含一个完整的字符一一对应</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508152916377-1547831720.png" alt="img"></p><p>调整每页后保存</p><h3 id="9-生成训练字包"><a href="#9-生成训练字包" class="headerlink" title="9.生成训练字包"></a>9.生成训练字包</h3><p>还在在jTessBoxEditor\tesseract-ocr文件夹内，新建一个批处理文件do.bat (命名随意) 内容：**<br>**</p><p>echo Run Tesseract for Training..<br>tesseract.exe num.font.exp0.tif num.font.exp0 nobatch box.train</p><p>echo Compute the Character Set..<br>unicharset_extractor.exe num.font.exp0.box<br>mftraining -F font_properties -U unicharset -O num.unicharset num.font.exp0.tr</p><p>echo Clustering..<br>cntraining.exe num.font.exp0.tr</p><p>echo Rename Files..<br>rename normproto num.normproto<br>rename inttemp num.inttemp<br>rename pffmtable num.pffmtable<br>rename shapetable num.shapetable</p><p>echo Create Tessdata..<br>combine_tessdata.exe num.</p><p>echo. &amp; pause</p><p>然后cmd 执行do.bat文件</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508154124262-7132036.png" alt="img"></p><p>之后生成多个文件</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508154357325-1914830655.png" alt="img"></p><p>红色框框便是我们要的训练库</p><p>最后测试结果 </p><p>var img &#x3D; new Bitmap(@”F:\1557288016(1).png”);<br>var ocr &#x3D; new TesseractEngine(@”F:\test\ConsoleApp1\TesseractDemo\tessdata”, “num”, EngineMode.Default);<br>var page &#x3D; ocr.Process(img);<br>Console.Write(page.GetText());</p><p><img src="https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508154556318-1059594318.png" alt="img"></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;一-简单使用Tesseract文字识别&quot;&gt;&lt;a href=&quot;#一-简单使用Tesseract文字识别&quot; class=&quot;headerlink&quot; title=&quot;一 .简单使用Tesseract文字识别&quot;&gt;&lt;/a&gt;&lt;strong&gt;一 .简单使用Tesseract文字识别&lt;/strong&gt;&lt;/h2&gt;&lt;h3 id=&quot;1-创建项目&quot;&gt;&lt;a href=&quot;#1-创建项目&quot; class=&quot;headerlink&quot; title=&quot;1.创建项目&quot;&gt;&lt;/a&gt;1.创建项目&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1153773/201905/1153773-20190508142803014-674497751.png&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Tesseract" scheme="https://kdt-g.github.io/tags/Tesseract/"/>
    
  </entry>
  
  <entry>
    <title>用jTessBoxEditorFX训练字库</title>
    <link href="https://kdt-g.github.io/2020/06/12/XCOy2dPpC/"/>
    <id>https://kdt-g.github.io/2020/06/12/XCOy2dPpC/</id>
    <published>2020-06-12T09:04:37.000Z</published>
    <updated>2022-03-26T17:02:59.223Z</updated>
    
    <content type="html"><![CDATA[<p>软件下载：<a href="https://sourceforge.net/projects/vietocr/files/jTessBoxEditor/">https://sourceforge.net/projects/vietocr/files/jTessBoxEditor/</a></p><p>官方字库下载：<a href="https://github.com/tesseract-ocr/tesseract/wiki/Data-Files#format-of-traineddata-files">https://github.com/tesseract-ocr/tesseract/wiki/Data-Files#format-of-traineddata-files</a></p><p>建议：普通版本和FX版本都下载，用普通版本调整坐标，用FX版本调整汉字识别。FX版本的坐标调整不能输入数字，一旦坐标偏移太大，简直就是反人类设计。</p><p>​     另外，也可以直接使用普通版本，虽然在Box Editor页面里看不到汉字，但是可以用Notepad++直接打开box文件进行文字编辑。</p><p>文中用的是FX2.0beta版，有些小问题，但是不影响使用，目前正式版应该是2.2。</p> <span id="more"></span><p>1、点击tools后再点击Merge TIFF，将所需要的图片集转换成tif格式，源图片集格式支持jpg和tif两种。合成的图片集命名格式为[chi_sim].[test].[exp0].tif 第一个空是字典格式，第二个字体（自定义）名字，第三个空位exp[0]。</p><p><img src="https://img2018.cnblogs.com/blog/1410220/201907/1410220-20190702100528189-539552896.png" alt="img"></p><p>2、生成BOX文件，D:\jTessBoxEditorFX\tesseract-ocr\tesseract.exe chi_sim.test.exp0.tif chi_sim.test.exp0 -l chi_sim batch.nochop makebox</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\temp\train2&gt;D:\jTessBoxEditorFX\tesseract-ocr\tesseract.exe chi_sim.test.exp1.tif chi_sim.test.exp1 -l chi_sim batch.nochop makebox</span><br><span class="line">Tesseract Open Source OCR Engine v4.00.00alpha with Leptonica</span><br><span class="line">Page 1</span><br><span class="line">Page 2</span><br><span class="line">Page 3</span><br><span class="line">Page 4</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-l chi_sim参数是使用已经有的中文训练字库</span><br><span class="line">这个字库是在tessdata目录里，可以自己拷贝进去</span><br></pre></td></tr></table></figure><p><img src="https://img2018.cnblogs.com/blog/1410220/201907/1410220-20190702100841739-1450625082.png" alt="img"></p><p>3、调整字体坐标，调整识别错误的汉字。使用open打开刚才生成的tif文件，根据刚才生成的box文件调整字库。这个步骤才是真正核心的步骤，也是最麻烦的地方。</p><p>调整坐标建议使用普通版本，FX版本无法手动调整坐标，不知道是不是故意设置还是BUG。</p><p><img src="https://img2018.cnblogs.com/blog/1410220/201907/1410220-20190702101012708-2051216997.png" alt="img"></p><p>merge合并的时候有几个图片文件，这里就需要按page页分别调整。</p><p>4、调整完成box文件后，就需要生成tr文件<br>D:\jTessBoxEditorFX\tesseract-ocr\tesseract.exe chi_sim.test.exp0.tif chi_sim.test.exp0 nobatch box.train</p><p>5、生成unicharset文件<br>D:\jTessBoxEditorFX\tesseract-ocr\unicharset_extractor.exe chi_sim.test.exp0.box</p><p>6、新建font_properties文件 用记事本新建一个明文font_properties.txt<br>内容格式为test 0 0 0 0 0，test是新建tif中间的内容（chi_sim.test.exp0.tif）。</p><p>7、在分别运行三个命令对tr特征集合进行操作</p><p>生成shape文件<br>D:\jTessBoxEditorFX\tesseract-ocr\shapeclustering.exe -F font_properties.txt -U unicharset chi_sim.test.exp0.tr</p><p>生成聚集字符特征文件<br>D:\jTessBoxEditorFX\tesseract-ocr\Mftraining.exe -F font_properties.txt -U unicharset -O unicharset chi_sim.test.exp0.tr</p><p>生成字符正常化特征文件<br>D:\jTessBoxEditorFX\tesseract-ocr\cntraining.exe chi_sim.test.exp0.tr</p><p>8、重命名把目录下的unicharset、inttemp、pffmtable、shapetable、normproto这五个文件前面都加上test.（就是你的tif中间的名字）</p><p>9、组合文件，成功后会生成test.traineddata训练库文件。</p><p>D:\jTessBoxEditorFX\tesseract-ocr\combine_tessdata test.（后面是有点的）</p><p>10、识别测试，把test.traineddata拷贝到D:\jTessBoxEditorFX\tesseract-ocr\tessdata目录下<br>D:\jTessBoxEditorFX\tesseract-ocr\tesseract chi_sim.test.exp0.tif output -l test</p><p>11、在代码中测试效果，可以全部识别出来，简单的代码之前发过（<a href="https://www.cnblogs.com/asker009/p/11098220.html">java 使用tess4j实现OCR的最简单样例</a>）</p><p><img src="https://img2018.cnblogs.com/blog/1410220/201907/1410220-20190702102524265-69688310.png" alt="img"></p><p><img src="https://img2018.cnblogs.com/blog/1410220/201907/1410220-20190702102547466-1148129948.png" alt="img"></p><p> 12、如果需要识别的图形比较复杂，一般情况下不能对整张图片进行识别，需要把图片分块识别，用代码也好实现，关键是准备阶段划分图片区域比较费事。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String args[]) throws Exception &#123;</span><br><span class="line">       ITesseract instance = new Tesseract();</span><br><span class="line">       instance.setDatapath(&quot;tessdata&quot;); //相对目录，这个时候tessdata目录和src目录平级</span><br><span class="line">       instance.setLanguage(&quot;test&quot;);//选择字库文件（只需要文件名，不需要后缀名）</span><br><span class="line">       try &#123;</span><br><span class="line">           File imageFile = new File(&quot;d:\\temp\\1.jpg&quot;);</span><br><span class="line">           BufferedImage bufferedImage = ImageIO.read(imageFile);</span><br><span class="line">           Rectangle rect = new Rectangle(2581,510,249,196);//按区域读取</span><br><span class="line">           String result2 = instance.doOCR(bufferedImage,rect);</span><br><span class="line">           System.out.println(result2);</span><br><span class="line">       &#125; catch (Exception e) &#123;</span><br><span class="line">           System.out.println(e.toString());</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;软件下载：&lt;a href=&quot;https://sourceforge.net/projects/vietocr/files/jTessBoxEditor/&quot;&gt;https://sourceforge.net/projects/vietocr/files/jTessBoxEditor/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;官方字库下载：&lt;a href=&quot;https://github.com/tesseract-ocr/tesseract/wiki/Data-Files#format-of-traineddata-files&quot;&gt;https://github.com/tesseract-ocr/tesseract/wiki/Data-Files#format-of-traineddata-files&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;建议：普通版本和FX版本都下载，用普通版本调整坐标，用FX版本调整汉字识别。FX版本的坐标调整不能输入数字，一旦坐标偏移太大，简直就是反人类设计。&lt;/p&gt;
&lt;p&gt;​     另外，也可以直接使用普通版本，虽然在Box Editor页面里看不到汉字，但是可以用Notepad++直接打开box文件进行文字编辑。&lt;/p&gt;
&lt;p&gt;文中用的是FX2.0beta版，有些小问题，但是不影响使用，目前正式版应该是2.2。&lt;/p&gt;</summary>
    
    
    
    
    <category term="jTessBoxEditorFX" scheme="https://kdt-g.github.io/tags/jTessBoxEditorFX/"/>
    
  </entry>
  
  <entry>
    <title>调用百度云接口实现文字识别功能</title>
    <link href="https://kdt-g.github.io/2020/06/12/37MmJjubk/"/>
    <id>https://kdt-g.github.io/2020/06/12/37MmJjubk/</id>
    <published>2020-06-12T09:02:49.000Z</published>
    <updated>2022-03-26T16:20:20.647Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HTML部分"><a href="#HTML部分" class="headerlink" title="HTML部分"></a>HTML部分</h2><span id="more"></span><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Test.aspx.cs&quot; Inherits=&quot;图片文字识别.Test&quot; %&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">runat</span>=<span class="string">&quot;server&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8;application/x-www-form-urlencoded&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://libs.baidu.com/jquery/2.0.0/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">submitXML</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获取提交的文件</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> fileInput = $(<span class="string">&#x27;#uploading&#x27;</span>).<span class="title function_">get</span>(<span class="number">0</span>).<span class="property">files</span>[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*判断是否选中文件*/</span> </span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (fileInput) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*选中后进行提交*/</span></span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#form1&quot;</span>).<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*如果没有选中文件进行提示*/</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&quot;请选择上传文件！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">runat</span>=<span class="string">&quot;server&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uploading&quot;</span> <span class="attr">id</span>=<span class="string">&quot;uploading&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">name</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;submitXML()&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;上传&quot;</span>  /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>识别到的数据：<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> /&gt;</span>       </span><br><span class="line">            &lt;%foreach (var item in ImageTxT)</span><br><span class="line">                &#123;%&gt;</span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&lt;%=item %&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            &lt;%&#125; %&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="第零步：判断是否提交表单和上传图片保存到服务器文件夹"><a href="#第零步：判断是否提交表单和上传图片保存到服务器文件夹" class="headerlink" title="第零步：判断是否提交表单和上传图片保存到服务器文件夹"></a>第零步：判断是否提交表单和上传图片保存到服务器文件夹</h2><h3 id="1-判断是否提交表单"><a href="#1-判断是否提交表单" class="headerlink" title="1)判断是否提交表单"></a>1)判断是否提交表单</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Test</span> : <span class="title">System.Web.UI.Page</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 识别出来的文字</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; ImageTxT = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Page_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//判断是否提交表单</span></span><br><span class="line">            <span class="keyword">if</span> (IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//获取到上传的文件</span></span><br><span class="line">                HttpPostedFile file = Request.Files[<span class="string">&quot;uploading&quot;</span>];</span><br><span class="line">                <span class="comment">//显示识别出来的文字</span></span><br><span class="line">                ImageTxT = Json.Json_ImageTXT_1(ImageFile.File(file));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-上传图片保存到服务器文件夹"><a href="#2-上传图片保存到服务器文件夹" class="headerlink" title="2)上传图片保存到服务器文件夹"></a>2)上传图片保存到服务器文件夹</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ImageFile</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 上传文件后保存在本地</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;file&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">File</span>(<span class="params">HttpPostedFile file</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (file.ContentLength &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//3、判断一下文件类型</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//3.1获取文件的类型</span></span><br><span class="line">                <span class="built_in">string</span> fileName = Path.GetFileName(file.FileName);</span><br><span class="line">                <span class="comment">//获取文件扩展名</span></span><br><span class="line">                <span class="built_in">string</span> fileExt = Path.GetExtension(fileName);</span><br><span class="line">                <span class="comment">//判断文件扩展名是否为jpg后缀  jjpg/jpeg/png/bmp</span></span><br><span class="line">                <span class="keyword">if</span> (fileExt == <span class="string">&quot;.jpg&quot;</span> || fileExt == <span class="string">&quot;.jjpg&quot;</span> || fileExt == <span class="string">&quot;.jpeg&quot;</span> || fileExt == <span class="string">&quot;.png&quot;</span> || fileExt == <span class="string">&quot;.bmp&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//上传上来的文件  名字 文件流MD5值 GUID(全局唯一的标识)</span></span><br><span class="line">                    <span class="built_in">string</span> newFileName = Guid.NewGuid().ToString();</span><br><span class="line">                    <span class="comment">//上传上来的文件 目录  设计分层的结构 日期</span></span><br><span class="line">                    <span class="comment">//string dir = &quot;/FileUP/LoadImage/&quot; + DateTime.Now.Year + &quot;/&quot; + DateTime.Now.Month + &quot;/&quot; + DateTime.Now.Day + &quot;/&quot;;</span></span><br><span class="line">                    <span class="built_in">string</span> dir = <span class="string">&quot;LoadImage/&quot;</span>;</span><br><span class="line">                    <span class="comment"><span class="doctag">///</span>/如果不存在对应日期的文件夹 创建</span></span><br><span class="line">                    <span class="keyword">if</span> (!Directory.Exists(HttpContext.Current.Request.MapPath(dir)))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">//创建文件夹</span></span><br><span class="line">                        Directory.CreateDirectory(HttpContext.Current.Request.MapPath(dir));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//string FullDir = dir + newFileName + fileExt;</span></span><br><span class="line">                    <span class="built_in">string</span> FullDir = dir + newFileName + fileExt;</span><br><span class="line">                    file.SaveAs(HttpContext.Current.Request.MapPath(FullDir));</span><br><span class="line">                    <span class="comment">//保存文件</span></span><br><span class="line">                    <span class="keyword">return</span> FullDir;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    HttpContext.Current.Response.Write(<span class="string">&quot;&lt;script&gt;alert(&#x27;暂不支持该文件类型！&#x27;);&lt;/script&gt;&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                HttpContext.Current.Response.Write(<span class="string">&quot;&lt;script&gt;alert(&#x27;请选择图片文件！&#x27;);&lt;/script&gt;&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="第一步：获取TOKEN的json串"><a href="#第一步：获取TOKEN的json串" class="headerlink" title="第一步：获取TOKEN的json串"></a>第一步：获取TOKEN的json串</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取TOKEN的json串</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">AccessToken</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 调用getAccessToken()获取的 access_token建议根据expires_in 时间 设置缓存</span></span><br><span class="line">    <span class="comment">// 返回token示例</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 百度云中开通对应服务应用的 API Key 建议开通应用的时候多选服务</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String clientId = <span class="string">&quot;lmpV2HQCskbvhdsP026bCYx3&quot;</span>;</span><br><span class="line">    <span class="comment">// 百度云中开通对应服务应用的 Secret Key</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String clientSecret = <span class="string">&quot;hXiv86Q7hM8sIV4u1oT2bGsEB4OrSYto&quot;</span>;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>获取TOKEN的json串的方法</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getAccessToken</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        String authHost = <span class="string">&quot;https://aip.baidubce.com/oauth/2.0/token&quot;</span>;</span><br><span class="line">        HttpClient client = <span class="keyword">new</span> HttpClient();</span><br><span class="line">        List&lt;KeyValuePair&lt;String, String&gt;&gt; paraList = <span class="keyword">new</span> List&lt;KeyValuePair&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;&gt;();</span><br><span class="line">        paraList.Add(<span class="keyword">new</span> KeyValuePair&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;(<span class="string">&quot;grant_type&quot;</span>, <span class="string">&quot;client_credentials&quot;</span>));</span><br><span class="line">        paraList.Add(<span class="keyword">new</span> KeyValuePair&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;(<span class="string">&quot;client_id&quot;</span>, clientId));</span><br><span class="line">        paraList.Add(<span class="keyword">new</span> KeyValuePair&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;(<span class="string">&quot;client_secret&quot;</span>, clientSecret));</span><br><span class="line"></span><br><span class="line">        HttpResponseMessage response = client.PostAsync(authHost, <span class="keyword">new</span> FormUrlEncodedContent(paraList)).Result;</span><br><span class="line">        String result = response.Content.ReadAsStringAsync().Result;</span><br><span class="line">        Console.WriteLine(result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第二步：解析TOKEN的json串"><a href="#第二步：解析TOKEN的json串" class="headerlink" title="第二步：解析TOKEN的json串"></a>第二步：解析TOKEN的json串</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> token的json串解析</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Json_token</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//获取到解析好的json串通过实体类使用数据</span></span><br><span class="line">            Jsontoken json = JsonConvert.DeserializeObject&lt;Jsontoken&gt;(AccessToken.getAccessToken());</span><br><span class="line"></span><br><span class="line">            <span class="comment">//返回获取到的 access_token  </span></span><br><span class="line">            <span class="keyword">return</span> json.access_token;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h2 id="第三步：把解析好的TOKEN的json串传入文字识别中充当必要参数-获取识别后的json串"><a href="#第三步：把解析好的TOKEN的json串传入文字识别中充当必要参数-获取识别后的json串" class="headerlink" title="第三步：把解析好的TOKEN的json串传入文字识别中充当必要参数,获取识别后的json串"></a>第三步：把解析好的TOKEN的json串传入文字识别中充当必要参数,获取识别后的json串</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">   <span class="comment"><span class="doctag">///</span> 图片文字识别</span></span><br><span class="line">   <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GeneralBasic</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> 进行文字识别</span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">generalBasic</span>(<span class="params"><span class="built_in">string</span> imageName</span>)</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="built_in">string</span> token = Json.Json_token();</span><br><span class="line">           <span class="comment">//通用文字识别</span></span><br><span class="line">           <span class="comment">//string host = &quot;https://aip.baidubce.com/rest/2.0/ocr/v1/general_basic?access_token=&quot; + token;</span></span><br><span class="line">           <span class="comment">//通用文字识别 含位置信息版</span></span><br><span class="line">           <span class="comment">//string host = &quot;https://aip.baidubce.com/rest/2.0/ocr/v1/general?access_token=&quot; + token;</span></span><br><span class="line">           <span class="comment">//通用文字识别  高精度版</span></span><br><span class="line">           <span class="comment">//string host = &quot;https://aip.baidubce.com/rest/2.0/ocr/v1/accurate_basic?access_token=&quot; + token;</span></span><br><span class="line">           <span class="comment">//通用文字识别 高精度含位置信息版</span></span><br><span class="line">           <span class="built_in">string</span> host = <span class="string">&quot;https://aip.baidubce.com/rest/2.0/ocr/v1/accurate?access_token=&quot;</span> + token;</span><br><span class="line">           Encoding encoding = Encoding.Default;</span><br><span class="line">           HttpWebRequest request = (HttpWebRequest)WebRequest.Create(host);</span><br><span class="line">           request.Method = <span class="string">&quot;post&quot;</span>;</span><br><span class="line">           request.KeepAlive = <span class="literal">true</span>;</span><br><span class="line">           <span class="comment">// 图片的base64编码</span></span><br><span class="line">           <span class="built_in">string</span> base64 = getFileBase64(System.AppDomain.CurrentDomain.BaseDirectory + imageName);</span><br><span class="line">           String str = <span class="string">&quot;image=&quot;</span> + HttpUtility.UrlEncode(base64);</span><br><span class="line">           <span class="built_in">byte</span>[] buffer = encoding.GetBytes(str);</span><br><span class="line">           request.ContentLength = buffer.Length;</span><br><span class="line">           request.GetRequestStream().Write(buffer, <span class="number">0</span>, buffer.Length);</span><br><span class="line">           HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line">           <span class="comment">//必须设置该步编码格式，不然会乱码</span></span><br><span class="line">           StreamReader reader = <span class="keyword">new</span> StreamReader(response.GetResponseStream(), Encoding.UTF8);</span><br><span class="line">           <span class="built_in">string</span> result = reader.ReadToEnd();</span><br><span class="line">           </span><br><span class="line">           <span class="keyword">return</span> result;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> 获取图片文件</span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">       <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFileBase64</span>(<span class="params">String fileName</span>)</span></span><br><span class="line">       &#123;</span><br><span class="line">           FileStream filestream = <span class="keyword">new</span> FileStream(fileName, FileMode.Open);</span><br><span class="line">           <span class="built_in">byte</span>[] arr = <span class="keyword">new</span> <span class="built_in">byte</span>[filestream.Length];</span><br><span class="line">           filestream.Read(arr, <span class="number">0</span>, (<span class="built_in">int</span>)filestream.Length);</span><br><span class="line">           <span class="built_in">string</span> baser64 = Convert.ToBase64String(arr);</span><br><span class="line">           filestream.Close();</span><br><span class="line">           <span class="keyword">return</span> baser64;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="第四步：解析识别后的json串"><a href="#第四步：解析识别后的json串" class="headerlink" title="第四步：解析识别后的json串"></a>第四步：解析识别后的json串</h2><h3 id="1-高低精度-不包括文字位置版"><a href="#1-高低精度-不包括文字位置版" class="headerlink" title="1.高低精度 不包括文字位置版"></a>1.高低精度 不包括文字位置版</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进行拼接解析好的数据，返回输出</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">Json_ImageTXT</span>(<span class="params"><span class="built_in">string</span> imageName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            JsonImageTXT json = JsonConvert.DeserializeObject&lt;JsonImageTXT&gt;(GeneralBasic.generalBasic(imageName));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//输出需要的数据</span></span><br><span class="line">            <span class="comment">//StringBuilder ImageTXT_Str = null;</span></span><br><span class="line">            List&lt;<span class="built_in">string</span>&gt; ImageTXT_Str = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; json.words_result.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                ImageTXT_Str.Add( json.words_result[i].words);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ImageTXT_Str;</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 不包含位置信息</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JsonImageTXT</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>唯一的log id，用于问题定位</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> log_id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 识别结果数，表示words_result的元素个数</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> words_result_num &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 识别结果数组</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> List&lt;WordsResult&gt; words_result &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WordsResult</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 识别结果字符串</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> words &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-高低精度-含文字位置版"><a href="#2-高低精度-含文字位置版" class="headerlink" title="2.高低精度 含文字位置版"></a>2.高低精度 含文字位置版</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进行拼接解析好的数据，返回输出（高低精度 含文字位置版）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">Json_ImageTXT_1</span>(<span class="params"><span class="built_in">string</span> imageName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            JsonImageTXT_1 json = JsonConvert.DeserializeObject&lt;JsonImageTXT_1&gt;(GeneralBasic.generalBasic(imageName));</span><br><span class="line"></span><br><span class="line">            List&lt;<span class="built_in">string</span>&gt; ImageTXT_Str_1 = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; json.words_result.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                ImageTXT_Str_1.Add(json.words_result[i].words+</span><br><span class="line">                    <span class="string">&quot;\r 高度：&quot;</span> + </span><br><span class="line">                    json.words_result[i].location.height + </span><br><span class="line">                    <span class="string">&quot;\r 宽度：&quot;</span> + </span><br><span class="line">                    json.words_result[i].location.width + </span><br><span class="line">                    <span class="string">&quot;\r 左间距：&quot;</span> + </span><br><span class="line">                    json.words_result[i].location.left + </span><br><span class="line">                    <span class="string">&quot;\r 上间距：&quot;</span> + </span><br><span class="line">                    json.words_result[i].location.top);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ImageTXT_Str_1;</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 含位置信息版</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JsonImageTXT_1</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 唯一的log id，用于问题定位</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> log_id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 识别结果数，表示words_result的元素个数</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> words_result_num &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 识别结果数组</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> List&lt;_Words_result&gt; words_result &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> _<span class="title">Words_result</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 文字位置</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> _location location &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 识别结果字符串</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> words &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> _<span class="title">location</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 宽度</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> width &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 上间距</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> top &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 左间距</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> left &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 高度</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> height &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;HTML部分&quot;&gt;&lt;a href=&quot;#HTML部分&quot; class=&quot;headerlink&quot; title=&quot;HTML部分&quot;&gt;&lt;/a&gt;HTML部分&lt;/h2&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
    <category term="文字识别" scheme="https://kdt-g.github.io/tags/%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB/"/>
    
  </entry>
  
  <entry>
    <title>c#连接web接口上传图片</title>
    <link href="https://kdt-g.github.io/2020/06/12/UR6JXKE2l/"/>
    <id>https://kdt-g.github.io/2020/06/12/UR6JXKE2l/</id>
    <published>2020-06-12T08:56:40.000Z</published>
    <updated>2022-03-26T17:01:17.659Z</updated>
    
    <content type="html"><![CDATA[<h2 id="代码如下："><a href="#代码如下：" class="headerlink" title="代码如下："></a>代码如下：</h2><span id="more"></span><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span>&#123;  </span><br><span class="line">Uri host = <span class="keyword">new</span> Uri(<span class="string">&quot;http://192.168.3.180:8089/api/tr-run/&quot;</span>);</span><br><span class="line">                    Encoding encoding = Encoding.Default;</span><br><span class="line">                    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(host);</span><br><span class="line">                    <span class="built_in">string</span> base64 = getFileBase64(<span class="string">@&quot;C:\Users\98468\Desktop\图片识别\5.png&quot;</span>);</span><br><span class="line">                    request.Method = <span class="string">&quot;post&quot;</span>;</span><br><span class="line">                    request.ContentType = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br><span class="line">                    request.KeepAlive = <span class="literal">true</span>;</span><br><span class="line">                    <span class="comment">// 图片的base64编码</span></span><br><span class="line">                    <span class="built_in">string</span> str = <span class="string">&quot;img=&quot;</span> + HttpUtility.UrlEncode(base64);</span><br><span class="line">                    <span class="built_in">byte</span>[] buffer = encoding.GetBytes(str);</span><br><span class="line">                    request.ContentLength = buffer.Length;</span><br><span class="line">                    request.GetRequestStream().Write(buffer, <span class="number">0</span>, buffer.Length);</span><br><span class="line">                    HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line">                    StreamReader reader = <span class="keyword">new</span> StreamReader(response.GetResponseStream(), Encoding.UTF8);</span><br><span class="line">                    <span class="built_in">string</span> result = reader.ReadToEnd();</span><br><span class="line">                    Console.WriteLine(result);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="built_in">string</span> <span class="title">getFileBase64</span>(<span class="params">String fileName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FileStream filestream = <span class="keyword">new</span> FileStream(fileName, FileMode.Open);</span><br><span class="line">            <span class="built_in">byte</span>[] arr = <span class="keyword">new</span> <span class="built_in">byte</span>[filestream.Length];</span><br><span class="line">            filestream.Read(arr, <span class="number">0</span>, (<span class="built_in">int</span>)filestream.Length);</span><br><span class="line">            <span class="built_in">string</span> baser64 = Convert.ToBase64String(arr);</span><br><span class="line">            filestream.Close();</span><br><span class="line">            <span class="keyword">return</span> baser64;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;代码如下：&quot;&gt;&lt;a href=&quot;#代码如下：&quot; class=&quot;headerlink&quot; title=&quot;代码如下：&quot;&gt;&lt;/a&gt;代码如下：&lt;/h2&gt;</summary>
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
    <category term="文字识别" scheme="https://kdt-g.github.io/tags/%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB/"/>
    
  </entry>
  
  <entry>
    <title>字符串转换为Unicode格式</title>
    <link href="https://kdt-g.github.io/2020/06/12/12aI-D5r8/"/>
    <id>https://kdt-g.github.io/2020/06/12/12aI-D5r8/</id>
    <published>2020-06-12T08:54:45.000Z</published>
    <updated>2022-03-26T16:11:42.688Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Unicode2String</span>(<span class="params"><span class="built_in">string</span> source</span>)</span></span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> Regex(<span class="string">@&quot;\\u([0-9A-F]&#123;4&#125;)&quot;</span>, RegexOptions.IgnoreCase | RegexOptions.Compiled).Replace(</span><br><span class="line">                       source, x =&gt; <span class="built_in">string</span>.Empty + Convert.ToChar(Convert.ToUInt16(x.Result(<span class="string">&quot;$1&quot;</span>), <span class="number">16</span>)));</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight c#&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;l</summary>
      
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>json解析（可以解决奇怪的json串）</title>
    <link href="https://kdt-g.github.io/2020/06/12/JEceyFXKd/"/>
    <id>https://kdt-g.github.io/2020/06/12/JEceyFXKd/</id>
    <published>2020-06-12T08:49:46.000Z</published>
    <updated>2020-06-12T08:54:14.961Z</updated>
    
    <content type="html"><![CDATA[<p>需要先引用     Newtonsoft.Json.dll</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test_json</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> a = <span class="string">&quot;&#123;\&quot;input\&quot;:&#123;\&quot;size\&quot;:193156,\&quot;type\&quot;:\&quot;image/png\&quot;&#125;,\&quot;output\&quot;:&#123;\&quot;size\&quot;:59646,\&quot;type\&quot;:\&quot;image/png\&quot;,\&quot;width\&quot;:487,\&quot;height\&quot;:284,\&quot;ratio\&quot;:0.3088,\&quot;url\&quot;:\&quot;https://api.tinify.com/output/hrqtghqtv0ab4qgv.png\&quot;&#125;&#125;&quot;</span>;</span><br><span class="line">            <span class="comment">//Console.WriteLine(a);</span></span><br><span class="line">            Newtonsoft.Json.Linq.JObject jobject =</span><br><span class="line">                (Newtonsoft.Json.Linq.JObject)Newtonsoft.Json.JsonConvert.DeserializeObject(a);</span><br><span class="line">            <span class="built_in">string</span> input_size = Convert.ToString(jobject[<span class="string">&quot;output&quot;</span>]);</span><br><span class="line">            Console.WriteLine(input_size);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;需要先引用     Newtonsoft.Json.dll&lt;/p&gt;
&lt;figure class=&quot;highlight c#&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span cl</summary>
      
    
    
    
    
    <category term="c#" scheme="https://kdt-g.github.io/tags/c/"/>
    
    <category term="Json" scheme="https://kdt-g.github.io/tags/Json/"/>
    
    <category term="有趣的编程知识" scheme="https://kdt-g.github.io/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
</feed>
